---
description:
globs:
alwaysApply: false
---
# 品詞分析・Ankiラベル管理

このルールは単語別表現ファイルにおける古典文法による品詞分析とAnkiラベル抽出・一覧表作成・優先度別学習戦略を管理します。

## 🏷️ Anki用ラベル抽出ルール

### 基本方針（絶対原則）
全ての単語別表現管理ファイルにおいて、**hinshi/フォルダの各主要品詞ページに記載された「末端品詞比較表」のAnkiラベルを完全準拠で使用する**。これは例外なく遵守すべき絶対原則である。

### 🚨 絶対的準拠原則
```yaml
必須準拠対象:
  - hinshi/副詞.md の末端品詞比較表
  - hinshi/名詞.md の末端品詞比較表  
  - hinshi/形容詞.md の末端品詞比較表
  - hinshi/動詞.md の末端品詞比較表
  - その他hinshi/内の全品詞ページの末端品詞比較表

絶対禁止事項:
  - 末端品詞比較表にないAnkiラベルの独自作成
  - 末端品詞比較表のAnkiラベルの独自変更
  - 表記の微細な変更・省略・追加

必須実行事項:
  - Ankiラベルは末端品詞比較表から完全一致で抽出
  - 複数候補がある場合のみ、文脈に基づく選択を実行
  - 該当するラベルがない場合は、最も近い分類を選択後、hinshi/ページの更新検討を提案
```

### Anki用ラベル抽出プロセス（改訂版）
```yaml
Step 1: 古典文法による品詞特定
  - 表現の核となる単語の品詞を古典文法基準で特定
  - 句動詞の場合: 副詞要素の品詞分類を確認
  - 慣用句の場合: 主要構成要素の品詞分類を確認

Step 2: hinshi/末端品詞比較表との厳密照合
  - 該当品詞ファイル（hinshi/名詞.md, hinshi/形容詞.md, hinshi/副詞.md等）を開く
  - **末端品詞比較表のAnkiラベル欄を厳密確認**
  - **完全一致するAnkiラベルを抽出（表記・大文字小文字・記号まで完全一致）**

Step 3: 表現特性に基づく最終選択（末端品詞比較表内でのみ）
  - 複数の候補ラベルがある場合のみ、表現特性で選択
  - 句動詞: 末端品詞比較表の句動詞関連ラベルから選択
  - 慣用句: 末端品詞比較表の「慣用句」ラベル、または主要構成要素の詳細ラベル
  - 前置詞句: 末端品詞比較表の「前置詞句」ラベル、または構成要素の詳細ラベル
```

### 品詞別Anki用ラベル抽出基準

#### 副詞要素を含む表現
```yaml
参照ファイル: hinshi/副詞.md
適用ラベル例:
  - 分離可能句動詞: 分離句動詞副詞
  - 固定句動詞: 固定句動詞副詞
  - 位置・方向表現: 位置副詞, 方向副詞
  - 時間表現: 時点副詞, 頻度副詞
```

#### 名詞要素を含む表現
```yaml
参照ファイル: hinshi/名詞.md
適用ラベル例:
  - 身体部位: 身体部位名詞
  - 場所・位置: 位置名詞, 場所名詞
  - 一般物体: 一般物体名詞
  - 抽象概念: 抽象名詞
```

#### 形容詞要素を含む表現
```yaml
参照ファイル: hinshi/形容詞.md
適用ラベル例:
  - 位置関係: 位置形容詞
  - 時間関係: 時間関係形容詞
  - 評価・性質: 評価的性質形容詞
```

### 複合表現のラベル抽出
```yaml
優先順位:
  1. 句動詞分類: 動詞+副詞の組み合わせ → 副詞分類優先
  2. 慣用句分類: 固定表現 → 「慣用句」ラベル
  3. 前置詞句: 前置詞+名詞等 → 「前置詞句」ラベル
  4. 構成要素分析: 主要要素の品詞ラベル適用

例:
  - "back up": 副詞"up"の分類 → 分離句動詞副詞
  - "behind one's back": 慣用的表現 → 慣用句
  - "at the back of": 前置詞句 → 前置詞句
```

## 📚 古典文法による品詞分類とAnkiラベル統合

### 必須追加セクション: Ankiラベル分類一覧表

#### セクション構造
古典文法品詞分類表の直後に、全てのAnkiラベルを統合した一覧表セクションを追加：

```markdown
## Ankiラベル分類一覧表

**参照基準**: hinshi/ 品詞学習システム ([日付]更新) 準拠  
**参照元**: [hinshi/README.md](hinshi/README.md) - 英語品詞学習システム  
**更新内容**: [具体的な変更内容がある場合に記載]

| 品詞分類 | 機能的分類 | Ankiラベル | 該当表現例 | TOEIC優先度 | 備考 |
|---------|------------|------------|-----------|-------------|------|
| **[品詞名]** | [機能的分類] | [具体的Ankiラベル] | "[表現例1]", "[表現例2]" | [0-100数値] | [特徴・使用場面] |
...
```

#### 表形式による効率化の利点
```yaml
簡潔性: 詳細説明セクションを廃止し、表形式のみで情報集約
一覧性: 全Ankiラベルを一目で比較・確認可能
学習効率: 重複情報を排除し、必要情報のみを整理
保守性: 1つの表を更新するだけで全情報を管理
検索性: 表形式により特定のラベル・優先度を迅速に検索
```

#### Ankiラベル分類一覧表の作成基準

**hinshi/参照基準の設定**:
```markdown
**参照基準**: hinshi/ 品詞学習システム ([日付]更新) 準拠  
**参照元**: [hinshi/README.md](hinshi/README.md) - 英語品詞学習システム  
**更新内容**: [具体的な変更内容がある場合に記載]
```

**必須カラム構成**:
```yaml
品詞分類: 古典文法による基本品詞分類
機能的分類: 品詞内での機能的カテゴリー分類
Ankiラベル: hinshi/フォルダからの具体的なラベル名
該当表現例: そのラベルに該当する具体的な表現（2-3例）
TOEIC優先度: 0-100の数値（TOEICでの重要度・頻出度）
備考: 特徴・使用場面・注意点の簡潔な説明
```

**hinshi/README.md更新日付管理**:
```yaml
確認基準: 
  - hinshi/README.mdの最終更新日付を基準とした整合性確認
  - 日付: hinshi/README.md末尾の「最終更新: YYYY-MM-DD」
  - 更新判定: この日付が変更された場合、全Ankiラベル分類の見直し実施

更新確認手順:
  1. hinshi/README.mdの最終更新日付を確認
  2. 各単語ファイルの参照基準日付と比較
  3. 差異がある場合は整合性確認を実施
  4. 必要に応じてAnkiラベル分類一覧表を更新
  5. 参照基準の日付を最新に更新
```

**TOEIC優先度設定基準**:
```yaml
100: 絶対必須 - TOEIC頻出、スコア直結
90-95: 超重要 - 基礎語彙として必須、高頻度使用
80-85: 重要 - 中級レベル必須、ビジネス・日常頻用
70-75: 標準 - 応用レベル、一般的使用
65以下: 補完 - 上級者向け補完知識、専門的・限定的用法
```

### 動的品詞判定によるラベル抽出ガイドライン

#### TOEIC優先度設定の基本原則
```yaml
最高優先度（90-100）: 
  - 句動詞構成要素（分離可能・固定問わず）
  - TOEIC超頻出の基本語彙機能
  - スコア直結型表現

高優先度（80-89）:
  - ビジネス文脈で頻繁に使用される機能
  - 日常的に使用される基本表現
  - 慣用性の高い固定表現

中優先度（70-79）:
  - 一般的な修飾機能・語彙機能
  - 標準的な語法・用法
  - 応用レベルの表現

低優先度（40-69）:
  - 専門的・限定的用法
  - 上級者向け表現
  - 文脈依存性の高い用法
```

#### hinshi/末端品詞比較表厳密準拠による品詞判定手順
```yaml
Step 1: 対象単語の品詞特定
  - 古典文法による基本品詞の確認
  - 多品詞性の有無確認
  - 文脈における主要機能の特定

Step 2: hinshi/末端品詞比較表との厳密照合
  - 該当品詞ファイル（hinshi/副詞.md、hinshi/名詞.md等）を開く
  - **末端品詞比較表のAnkiラベル欄を厳密確認**
  - **完全一致するAnkiラベルのみを候補として抽出**
  - **独自解釈・独自作成は絶対禁止**

Step 3: 表現特性による優先度判定（末端品詞比較表準拠）
  - 句動詞: 末端品詞比較表の句動詞ラベル + TOEIC出題頻度による重要度判定
  - 名詞用法: 末端品詞比較表の名詞ラベル + 使用頻度による重要度判定  
  - 副詞用法: 末端品詞比較表の副詞ラベル + 修飾機能による重要度判定
  - 形容詞用法: 末端品詞比較表の形容詞ラベル + 使用場面による重要度判定
  - 慣用句: 末端品詞比較表の「慣用句」ラベル + TOEIC出題頻度による判定
  - 前置詞句: 末端品詞比較表の「前置詞句」ラベル + 使用頻度による判定
```

#### ラベル抽出・優先度判定の実装原則（末端品詞比較表厳密準拠版）  
```yaml
参照基準設定（絶対原則）:
  - hinshi/各品詞ページの末端品詞比較表のAnkiラベル欄に厳密準拠
  - hinshi/README.mdの最終更新日付を基準とした整合性管理
  - 末端品詞比較表の表記に完全一致（大文字小文字・記号・スペース含む）
  - バージョン管理ではなく更新日付による管理

Ankiラベル抽出の絶対制約:
  - 末端品詞比較表にあるAnkiラベルのみ使用可能
  - 独自作成・独自変更・独自解釈は絶対禁止
  - 表記の微細な変更も禁止（「分離可能句動詞副詞」→「分離句動詞副詞」等）
  - 該当ラベルがない場合は最も近い分類を選択し、hinshi/ページ更新を提案

優先度決定要因:
  - TOEIC出題頻度・重要度
  - ビジネス文脈での実用性
  - 学習段階における必要性
  - 表現の慣用性・固定性

品質保証（末端品詞比較表準拠）:
  - hinshi/末端品詞比較表との完全一致確認
  - 既存実装例との一貫性確認（末端品詞比較表経由）
  - 学習効率・記憶効果の最適化確認
```

## 🎯 完了基準

### 品詞分析関連の完了基準
- [ ] Anki用ラベルの適切な設定
- [ ] 8つの古典文法品詞すべてを○×で判定完了
- [ ] 主な機能・用法の簡潔な説明記載完了  
- [ ] 代表例の適切な選定・記載完了

### Ankiラベル分類一覧表の完了基準
- [ ] 全Ankiラベルの表形式一覧化完了
- [ ] hinshi/README.md参照基準の設定・記録完了
- [ ] TOEIC優先度（40-100）の適切な設定完了
- [ ] 品詞分類・機能的分類・備考の記載完了
- [ ] 該当表現例の具体的記載完了
- [ ] **古典文法品詞分類表との整合性確認完了**

### 古典文法品詞分類表との整合性チェック（必須）

#### 整合性確認の重要性
古典文法における品詞分類チェック表で○が付いている品詞については、対応するAnkiラベルが適切に設定されている必要がある。

#### 必須整合性チェック手順
```yaml
Step 1: 古典文法品詞分類表の○品詞確認
  - 名詞：○ → 名詞関連Ankiラベルの存在確認
  - 動詞：○ → 動詞関連Ankiラベルの存在確認
  - 形容詞：○ → 形容詞関連Ankiラベルの存在確認
  - 副詞：○ → 副詞関連Ankiラベルの存在確認
  - 代名詞：○ → 代名詞関連Ankiラベルの存在確認
  - 前置詞：○ → 前置詞関連Ankiラベルの存在確認
  - 接続詞：○ → 接続詞関連Ankiラベルの存在確認
  - 間投詞：○ → 間投詞関連Ankiラベルの存在確認

Step 2: 不整合検出時の対応
  - 古典文法で○だがAnkiラベルなし → ラベル追加
  - 古典文法で×だがAnkiラベルあり → 古典文法分類見直しまたはラベル削除
  - 品詞機能と設定ラベルの論理的整合性確認

Step 3: 品詞別ラベル適切性確認
  - 各品詞の○判定理由とAnkiラベルの機能的一致性
  - hinshi/フォルダの該当品詞詳細分類との照合
  - 学習効果を考慮した適切なラベル選択
```

#### 整合性チェックの実行基準
```yaml
必須実行タイミング:
  - 古典文法品詞分類表作成・更新時
  - Ankiラベル分類一覧表作成・更新時
  - 品詞判定の変更時（○→×、×→○）

品質基準:
  - 100%整合性：古典文法○品詞は全てAnkiラベル設定済み
  - 論理的一致性：品詞機能とラベル分類の論理的整合
  - 学習効率性：適切な優先度設定とラベル選択
```

#### 不整合発見時の修正手順
```yaml
古典文法○ + Ankiラベルなし:
  1. hinshi/該当品詞ファイルでラベル候補検索
  2. 単語の機能・用法に最適なラベル選択
  3. 適切な優先度設定（TOEIC重要度基準）
  4. Ankiラベル分類一覧表に追加

古典文法× + Ankiラベルあり:
  1. 品詞判定の再検証（用法・機能の確認）
  2. 古典文法分類の修正 OR Ankiラベルの削除
  3. 両セクション間の整合性確保

品詞機能とラベル不一致:
  1. より適切なAnkiラベルへの変更
  2. hinshi/フォルダ基準での詳細分類確認
  3. 学習効果を考慮した最適化
```

## 🔍 セクション3: Ankiラベル網羅性・整合性チェック

### 概要
単語別表現ファイル内の「Ankiラベル分類一覧表」と「Ankiラベル別実用文例」セクション間の完全な整合性・網羅性を確保するための包括的検証システム。

### 必須チェック項目

#### 基本網羅性チェック
```yaml
チェック1: 分類一覧表→実用文例の網羅性
  - 分類一覧表に記載された全Ankiラベルが実用文例セクションに存在するか
  - 漏れているラベルの特定と報告
  - 優先度別の網羅状況確認（高優先度ラベルの優先的確認）

チェック2: 実用文例→分類一覧表の整合性
  - 実用文例セクションの全Ankiラベルが分類一覧表に定義されているか
  - 未定義ラベルの特定と報告
  - 表記揺れ・誤記の検出

チェック3: ラベル表記の統一性
  - 両セクション間でのラベル名の完全一致確認
  - 大文字小文字・記号の統一性検証
  - 略記法・表記方法の一貫性確認
```

#### 優先度整合性チェック
```yaml
チェック4: TOEIC優先度の一致性
  - 分類一覧表の優先度と実用文例の優先度が一致しているか
  - 優先度数値の範囲適正性（40-100）確認
  - 5刻み原則の遵守状況確認

チェック5: 優先度の妥当性検証
  - 同一ラベル内での優先度一貫性確認
  - 機能的重要度と設定優先度の論理的整合性
  - TOEIC出題頻度と優先度設定の適切性
```

#### 品質統合チェック
```yaml
チェック6: 分類品質の統一性
  - 品詞分類の表記統一性（古典文法基準）
  - 機能的分類の論理的一貫性
  - hinshi/フォルダ参照基準との整合性

チェック7: 内容品質の統合確認
  - 該当表現例の実用文例での具体化確認
  - 備考内容と実用文例での文脈説明の整合性
  - 学習効果の相互補完関係確認
```

### 自動化チェック手順

#### Step 1: 基礎データ抽出
```yaml
抽出対象:
  1. 分類一覧表からの全Ankiラベルリスト作成
  2. 実用文例セクションからの全Ankiラベルリスト作成
  3. 各ラベルの優先度数値の抽出
  4. 各ラベルの出現回数・使用頻度の計算

実装方法:
  - 表形式データの構造化抽出
  - ラベル名の正規化処理
  - 優先度数値の範囲・形式検証
  - 重複・誤記の事前検出
```

#### Step 2: 網羅性分析
```yaml
網羅性計算:
  - 分類一覧表ラベル数: A個
  - 実用文例ラベル数: B個
  - 一致ラベル数: C個
  - 網羅率: C/A × 100%
  - 整合率: C/B × 100%

品質閾値:
  - 網羅率目標: 100%（完全網羅）
  - 整合率目標: 100%（完全整合）
  - 許容範囲: 一時的な95%以上（更新作業中のみ）
```

#### Step 3: 差異詳細分析
```yaml
漏れ分析:
  - 分類一覧表にあり実用文例にないラベル特定
  - 優先度別の漏れ状況分析
  - 漏れラベルの重要度評価

過剰分析:
  - 実用文例にあり分類一覧表にないラベル特定
  - 未定義ラベルの妥当性評価
  - 新規ラベル追加の必要性判定

不一致分析:
  - 優先度数値の不一致詳細
  - 表記揺れの具体的箇所
  - 修正優先順位の決定
```

### 検証レポート形式

#### 必須レポート項目
```markdown
## Ankiラベル網羅性・整合性検証レポート

### 基本統計
- **検証日時**: [実行日時]
- **対象ファイル**: [ファイル名]
- **分類一覧表ラベル数**: A個
- **実用文例ラベル数**: B個
- **一致ラベル数**: C個
- **網羅率**: X.X%
- **整合率**: Y.Y%

### 漏れ検出結果
#### 分類一覧表→実用文例の漏れ
- [ ] **[ラベル名1]** (優先度: XX) - [重要度評価]
- [ ] **[ラベル名2]** (優先度: XX) - [重要度評価]

#### 実用文例→分類一覧表の未定義
- [ ] **[ラベル名1]** - [妥当性評価]
- [ ] **[ラベル名2]** - [妥当性評価]

### 優先度不一致
- [ ] **[ラベル名]**: 分類一覧表(XX) vs 実用文例(YY)

### 表記揺れ検出
- [ ] **[ラベル名1]** vs **[ラベル名2]** - [統一案]

### 推奨修正アクション
1. **高優先度**: [具体的修正内容]
2. **中優先度**: [具体的修正内容]
3. **低優先度**: [具体的修正内容]
```

### 修正実行手順

#### 即座修正項目（自動実行可能）
```yaml
優先度1: 明確な表記揺れ
  - 大文字小文字の統一
  - 記号・スペースの統一
  - 明らかな誤記の修正

優先度2: 優先度数値の形式統一
  - 5刻み原則への調整
  - 範囲外数値の適正化
  - 未設定値のデフォルト設定
```

#### 慎重判断項目（ユーザー確認後実行）
```yaml
優先度3: ラベル追加・削除
  - 新規ラベルの分類一覧表追加
  - 不要ラベルの実用文例から削除
  - カテゴリー変更の実施

優先度4: 優先度値の変更
  - 論理的不整合の優先度調整
  - TOEIC重要度反映の優先度変更
  - 学習効果最適化の優先度設定
```

### 継続的品質管理

#### 定期実行スケジュール
```yaml
実行タイミング:
  - 新規文例追加時: 必須
  - 分類一覧表更新時: 必須
  - hinshi/README.md更新後: 必須
  - 月次定期チェック: 推奨

品質維持基準:
  - 網羅率: 100%維持
  - 整合率: 100%維持
  - 検証頻度: 月1回以上
```

#### 改善ループの確立
```yaml
継続改善サイクル:
  1. 定期検証実行
  2. 問題点の体系的分析
  3. 修正優先順位の決定
  4. 段階的修正実施
  5. 改善効果の測定
  6. 品質基準の見直し
```

### 完了基準（網羅性・整合性チェック）
- [ ] **基本網羅性**: 分類一覧表と実用文例間の100%網羅確認
- [ ] **逆方向整合性**: 実用文例の全ラベルが分類一覧表で定義済み確認
- [ ] **表記統一性**: ラベル名の完全一致・表記揺れゼロ確認
- [ ] **優先度整合性**: 両セクション間での優先度数値一致確認
- [ ] **品質統合性**: 分類・説明・文例の論理的整合性確認
- [ ] **継続管理体制**: 定期チェック・改善ループの確立
- [ ] **検証レポート**: 包括的な検証結果レポートの作成・記録
- [ ] **連鎖的整合性**: 前段階修正に伴う後続セクションの整合性確認完了

## 🔄 セクション4: 連鎖的整合性管理

### 概要
単語別表現ファイル内のセクション間で発生する段階的詳細化に対応した連鎖的整合性確保システム。前段階のセクション修正時に、後続の全セクションの整合性を自動的に確認・更新する包括的管理体制。

### セクション階層構造と連鎖関係

#### 基本階層構造
```yaml
Level 1: 古典文法における品詞分類 (基礎層)
  ↓ 詳細化・具体化
Level 2: Ankiラベル分類一覧表 (詳細層)
  ↓ 実用化・例文化
Level 3: Ankiラベル別実用文例 (実用層)
  ↓ 包括的実装
Level 4: 表現一覧 (総合実装層)

連鎖的影響:
  Level 1修正 → Level 2, 3, 4の整合性確認必須
  Level 2修正 → Level 3, 4の整合性確認必須
  Level 3修正 → Level 4の整合性確認必須
```

#### セクション間依存関係マップ
```yaml
古典文法品詞分類:
  影響先: Ankiラベル分類一覧表、実用文例、表現一覧
  影響内容: 品詞判定変更（○→×、×→○）による全体構造変更

Ankiラベル分類一覧表:
  影響先: 実用文例、表現一覧
  影響内容: ラベル追加・削除・変更による文例・表現の対応関係変更

実用文例:
  影響先: 表現一覧
  影響内容: 文例追加・優先度変更による表現分類の見直し

表現一覧:
  影響先: なし（最終層）
  影響内容: 独立的修正のみ
```

### 連鎖的整合性チェック手順

#### Stage 1: 修正発生段階の特定
```yaml
修正検出システム:
  1. どのセクションで修正が発生したかの特定
  2. 修正内容の分類（追加・削除・変更・優先度変更）
  3. 影響範囲の予測と後続セクションの特定
  4. 連鎖チェックの実行優先順位決定

修正タイプ別影響分析:
  - 古典文法○→×: 該当品詞の全Ankiラベル削除検討
  - 古典文法×→○: 該当品詞のAnkiラベル追加必須
  - Ankiラベル追加: 対応する実用文例の追加必須
  - Ankiラベル削除: 対応する実用文例の削除検討
  - 優先度変更: 全セクションでの優先度統一必須
```

#### Stage 2: 後続セクション自動チェック
```yaml
Level 1 → Level 2チェック:
  - 古典文法○品詞にAnkiラベル存在確認
  - 古典文法×品詞のAnkiラベル不適切存在確認
  - 新規○品詞の適切なラベル候補提案

Level 2 → Level 3チェック:
  - 新規Ankiラベルの実用文例存在確認
  - 削除Ankiラベルの実用文例削除確認
  - 優先度変更の実用文例への反映確認

Level 3 → Level 4チェック:
  - 新規実用文例に対応する表現一覧エントリ確認
  - 実用文例の文脈と表現一覧の分類整合性確認
  - TOEIC優先度の表現一覧スコア設定整合性確認

全レベル横断チェック:
  - 用語・表記の統一性確認
  - TOEIC優先度の一貫性確認
  - 学習効果の最適化確認
```

#### Stage 3: 自動修正提案生成
```yaml
必須修正項目（自動実行可能）:
  1. 明確な不整合の修正
     - 古典文法○品詞の未対応Ankiラベル追加
     - 削除されたラベルの実用文例削除
     - 優先度数値の統一
  
  2. 表記・形式の統一
     - ラベル名の統一
     - 優先度表記の統一
     - 文例形式の統一

推奨修正項目（ユーザー確認後実行）:
  1. 内容的最適化
     - より適切なラベル選択
     - 文例の質向上
     - 学習効果の最適化
  
  2. 構造的改善
     - セクション構成の改善
     - 情報配置の最適化
     - 関連性の強化
```

### 連鎖的修正実行プロトコル

#### 自動実行段階
```yaml
Phase 1: 緊急整合性修正
  実行条件: 明確な不整合・矛盾の検出
  実行内容:
    - 古典文法○品詞への対応Ankiラベル即座追加
    - 削除ラベルの実用文例即座削除
    - 優先度数値の自動統一
    - **意味・Ankiラベル順序の自動維持**
    - **重複エントリの即座検出・除去**
  
  実行基準:
    - 100%確実な修正のみ
    - 既存内容を損なわない修正
    - 学習効果を低下させない修正
    - **3段階ソート順序構造の維持**
    - **一意性の完全保証**

Phase 2: 形式統一修正
  実行条件: 表記・形式の不統一検出
  実行内容:
    - ラベル表記の統一
    - 数値形式の統一
    - 文例構造の統一
    - **意味・Ankiラベル順序の再整列実行**
    - **全体一意性の最終検証**

Phase 3: 重複検証・品質保証
  実行条件: Phase 1-2完了後の最終確認
  実行内容:
    - Level 1-3重複検出の完全実行
    - 一意性維持原則の全項目確認
    - 学習効率への影響評価
    - 必要に応じた追加統合・削除
```

#### ユーザー確認段階
```yaml
Phase 3: 内容最適化提案
  提案内容:
    - より適切なAnkiラベルの提案
    - 学習効果向上の文例追加提案
    - TOEIC重要度に基づく優先度調整提案
  
  確認事項:
    - 提案内容の妥当性
    - 学習効果への影響
    - 実装優先順位

Phase 4: 包括的品質向上
  提案内容:
    - セクション構成の改善
    - 相互参照の強化
    - 学習フローの最適化
```

### 連鎖的整合性レポート形式

#### 必須レポート項目
```markdown
## セクション間連鎖的整合性検証レポート

### 修正発生情報
- **修正セクション**: [Level X: セクション名]
- **修正内容**: [具体的修正内容]
- **修正タイプ**: [追加・削除・変更・優先度変更]
- **影響予測**: [後続セクションへの影響範囲]

### 連鎖チェック結果
#### Level 1 → Level 2整合性
- [ ] **品詞○→Ankiラベル存在**: 完全対応 / 部分対応 / 未対応
- [ ] **品詞×→Ankiラベル不存在**: 適切 / 要修正
- [ ] **新規品詞○→新規ラベル**: 追加済み / 要追加

#### Level 2 → Level 3整合性
- [ ] **新規ラベル→実用文例**: 追加済み / 要追加
- [ ] **削除ラベル→文例削除**: 削除済み / 要削除
- [ ] **優先度変更→文例反映**: 反映済み / 要反映

#### Level 3 → Level 4整合性
- [ ] **新規文例→表現一覧**: 対応済み / 要対応
- [ ] **文例内容→表現分類**: 整合 / 要調整
- [ ] **優先度→スコア設定**: 整合 / 要調整

### 自動修正実行結果
#### Phase 1: 緊急整合性修正
- ✅ [実行内容1]: 成功
- ✅ [実行内容2]: 成功

#### Phase 2: 形式統一修正
- ✅ [実行内容1]: 成功
- ⚠️ [実行内容2]: 要確認

### ユーザー確認要求項目
#### Phase 3: 内容最適化提案
- [ ] **提案1**: [具体的提案内容] - [理由・効果]
- [ ] **提案2**: [具体的提案内容] - [理由・効果]

#### Phase 4: 包括的品質向上
- [ ] **改善案1**: [具体的改善案] - [期待効果]
- [ ] **改善案2**: [具体的改善案] - [期待効果]

### 品質指標
- **連鎖整合率**: XX.X% (目標: 100%)
- **自動修正成功率**: XX.X% (目標: 95%以上)
- **学習効果維持率**: XX.X% (目標: 100%)
```

### 継続的連鎖管理体制

#### 予防的管理システム
```yaml
事前チェック体制:
  - セクション修正前の影響予測実行
  - 修正計画の段階的検証
  - リスク評価に基づく実行判断

リアルタイム監視:
  - 修正実行中の整合性リアルタイム確認
  - 異常検出時の即座停止・修正
  - 品質劣化の早期発見・対応

事後検証体制:
  - 修正完了後の包括的整合性確認
  - 学習効果への影響測定
  - 改善効果の定量的評価
```

#### 学習・改善ループ
```yaml
パターン学習:
  - 頻発する不整合パターンの特定
  - 効果的な修正手順の蓄積
  - 予防策の体系的構築

品質基準の進化:
  - 連鎖整合性基準の継続的改善
  - 新しいセクション構造への対応
  - 学習効果最適化の追求
```

### 重複検証・一意性管理

#### 重複発生パターンの分析
```yaml
主要重複パターン:
  緊急修正時重複:
    - 新規エントリ追加時に既存内容との重複チェック不備
    - 同一ラベル・同一意味の文例が複数番号で存在
    - 異なる文章だが本質的に同一内容の重複

  並び替え時重複:
    - 優先度順序修正時の既存エントリ保持ミス
    - 移動対象エントリが元位置と新位置の両方に残存
    - 番号再採番時の重複生成

  系統的重複:
    - 同一Ankiラベルでの文例内容の実質的重複
    - 類似表現の過度な細分化による冗長性
```

#### 自動重複検出システム
```yaml
検出アルゴリズム:
  Level 1 - 完全一致検出:
    - 文例内容の完全一致
    - 日本語訳の完全一致
    - ラベル＋意味の完全一致

  Level 2 - 実質的重複検出:
    - 同一ラベル内での類似文例（80%以上の類似度）
    - 同一TOEIC出題文脈での重複
    - 語彙・構文が本質的に同一の文例

  Level 3 - 冗長性検出:
    - 同一優先度グループ内での過密化
    - 学習効果の重複による非効率性
    - Ankiカード化時の重複問題
```

#### 追加・修正時の必須チェックリスト
```yaml
新規エントリ追加時:
  事前チェック:
    - [ ] 同一ラベルの既存エントリ全件確認
    - [ ] 文例内容の類似度チェック（< 70%）
    - [ ] 意味・用法の差別化確認
    - [ ] TOEIC出題文脈の重複回避

  追加後検証:
    - [ ] 全エントリの一意性確認
    - [ ] 優先度順序の正確性確認
    - [ ] 番号連続性の確認

並び替え・修正時:
  実行前準備:
    - [ ] 移動対象エントリの明確化
    - [ ] 既存構造への影響範囲特定
    - [ ] 重複発生リスク箇所の特定

  実行後検証:
    - [ ] 移動元位置からの完全削除確認
    - [ ] 移動先位置での正確配置確認
    - [ ] 全体番号の連続性確認
    - [ ] 重複エントリの完全除去確認
```

#### 一意性維持の原則
```yaml
文例レベル一意性:
  基準: 同一ラベル内で文例内容が実質的に異なること
  許容: 構文は類似でも語彙・文脈が明確に異なる場合
  禁止: 単語レベルの変更のみの類似文例

意味・用法レベル一意性:
  基準: 同一ラベル内で意味・用法が明確に区別できること
  許容: 同一動詞でも異なるニュアンス・使用場面
  禁止: 表現方法のみ異なる本質的に同一の用法

優先度レベル一意性:
  基準: 各優先度グループ内でバランスの取れた分布
  許容: 重要度に応じた自然な偏り
  禁止: 特定優先度での過度な集中による学習偏重
```

### 意味・Ankiラベル順序管理

#### 意味・ラベル順序の重要性
単語別表現ファイルの「Ankiラベル別実用文例」セクションでは、学習の論理性・体系性最大化のため**意味→Ankiラベル→TOEIC優先度**の3段階ソート順序での配列が必須。

#### 3段階ソート順序システム
```yaml
ソート階層:
  第1ソート: 意味・用法分類
    - 同じ意味・機能の表現を最優先でグループ化
    - 例: "後ろ・背後"系 → "支援・援助"系 → "戻る・復帰"系
  
  第2ソート: Ankiラベル分類
    - 同一意味内でAnkiラベルによる品詞・機能別整理
    - 例: 位置副詞 → 慣用句 → 前置詞句 → 一般物体名詞
  
  第3ソート: TOEIC優先度（降順）
    - 同一意味・ラベル内でのTOEIC重要度順配列
    - 例: 100 → 95 → 90 → 85 → 80

挿入位置決定アルゴリズム:
  1. 新規エントリの意味分類を特定
  2. 該当意味グループ内でのAnkiラベル位置を特定
  3. 同一ラベル内でのTOEIC優先度に基づく挿入位置決定
  4. 後続エントリのNo.を自動調整

緊急修正時の順序チェック:
  - Phase 1実行後の即座順序検証
  - 意味分散・ラベル混在の自動検出
  - 必要に応じてPhase 2での自動再整列
```

#### 意味分類体系
```yaml
基本意味分類（backの例）:
  1. 位置・場所系:
     - 後方位置表現
     - 背後・裏側表現
     - 遠距離・離れた位置表現
  
  2. 動作・移動系:
     - 戻る・復帰動作
     - 後退・引き下がり動作
     - 逆方向移動表現
  
  3. 支援・援助系:
     - 支持・サポート表現
     - 補助・協力表現
     - 後押し・応援表現
  
  4. 時間・過去系:
     - 過去・以前表現
     - 昔・旧来表現
     - 時間的後退表現

各意味分類内でのAnkiラベル標準順序:
  1. 副詞系ラベル（位置副詞、方向副詞等）
  2. 慣用句ラベル
  3. 前置詞句ラベル
  4. 名詞系ラベル（位置名詞、一般物体名詞等）
  5. その他の品詞ラベル
```

#### 順序検証チェックリスト
```yaml
必須確認項目:
  - [ ] 同じ意味の表現が適切にグループ化されているか
  - [ ] 各意味グループ内でAnkiラベル順序が正しいか
  - [ ] 同一意味・ラベル内でTOEIC優先度順（降順）が維持されているか
  - [ ] No.の連番が正しく維持されているか
  - [ ] 新規追加エントリが適切な3段階位置に配置されているか

意味・ラベル混在パターンの検出:
  - 異なる意味の表現が混在するパターン
  - 同一意味内でのAnkiラベル順序違反パターン
  - 同一意味・ラベル内でのTOEIC優先度逆転パターン
```

#### 自動修正実行手順
```yaml
Step 1: 意味・ラベル分類分析
  - 全エントリの意味分類を特定
  - 各エントリのAnkiラベル分類を確認
  - TOEIC優先度値をスキャン

Step 2: 3段階ソート計算
  - 意味分類による第1ソートグループ作成
  - Ankiラベルによる第2ソートグループ作成
  - TOEIC優先度による第3ソート（降順）実行

Step 3: 構造保持修正実行
  - 既存エントリの内容を完全保持
  - No.と配列順序のみを3段階ソート結果に調整
  - 学習内容・文例品質の維持
  - 論理的構造と学習効率の両立
```

### 完了基準（連鎖的整合性）
- [ ] **修正影響範囲**: 後続全セクションの影響範囲特定完了
- [ ] **自動整合性確認**: 全セクション間の自動整合性チェック完了
- [ ] **緊急修正実行**: 明確な不整合の即座修正完了
- [ ] **重複検証完了**: Level 1-3重複検出・除去の完全実行完了
- [ ] **一意性確認**: 文例・意味・優先度レベル一意性の確認完了
- [ ] **順序構造確認**: 意味→Ankiラベル→TOEIC優先度の3段階ソート配列維持確認完了
- [ ] **番号連続性確認**: 全エントリ番号の連続性・整合性確認完了
- [ ] **提案生成**: 内容最適化・品質向上提案の生成完了
- [ ] **連鎖レポート**: 包括的な連鎖的整合性レポート作成完了
- [ ] **予防体制**: 将来の連鎖的修正への予防体制確立完了

## 関連ファイル

### 統合管理ルール
- [[200-単語別表現管理.mdc]] - マスター統合管理・ナビゲーション
- [[201-単語別基本構造管理.mdc]] - 基本構造・分類基準
- [[203-慣用句・句動詞分類管理.mdc]] - 慣用句・句動詞の詳細分類
- [[204-Anki文例セクション管理.mdc]] - Ankiラベル別実用文例セクション

### 基本方針・分類管理ルール
- [[100-基本方針.mdc]] - TOEIC学習・語学分析・慣用句・句動詞の包括的基本方針
- [[104-表現分類管理.mdc]] - 品詞分類に特化した専門管理

### hinshi/品詞詳細分類参照（主要8品詞）
- [[hinshi/名詞.md]] - 名詞詳細分類の参照元
- [[hinshi/動詞.md]] - 動詞詳細分類の参照元
- [[hinshi/形容詞.md]] - 形容詞詳細分類の参照元
- [[hinshi/副詞.md]] - 副詞詳細分類の参照元
- [[hinshi/代名詞.md]] - 代名詞詳細分類の参照元
- [[hinshi/前置詞.md]] - 前置詞詳細分類の参照元
- [[hinshi/接続詞.md]] - 接続詞詳細分類の参照元
- [[hinshi/間投詞.md]] - 間投詞詳細分類の参照元

### hinshi/システム管理
- [[hinshi/README.md]] - 品詞学習システム全体概要・更新日付管理
