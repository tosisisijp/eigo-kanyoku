---
description: "PowerShellæ“ä½œæ™‚ã®å•é¡Œå¯¾å‡¦ãƒ»AIæœ€é©åŒ–ãƒ»æ–‡å­—ã‚³ãƒ¼ãƒ‰æ¤œè¨¼ãƒ»é–¢æ•°æ°¸ç¶šæ€§ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®åŒ…æ‹¬çš„ã‚¬ã‚¤ãƒ‰"
globs: ["*.ps1", "*.md", ".cursor/rules/*.mdc", "script/*.ps1"]
alwaysApply: false
---
# PowerShellæ“ä½œã‚¬ã‚¤ãƒ‰

## ç›®çš„
- PowerShellä½¿ç”¨æ™‚ã®å…¸å‹çš„ãªå•é¡Œã¨ãã®å¯¾å‡¦æ³•ã‚’æä¾›
- æ–‡å­—ã‚³ãƒ¼ãƒ‰ãƒ»æ”¹è¡Œã‚³ãƒ¼ãƒ‰ç¢ºèªã®æ¨™æº–æ‰‹é †ã‚’ç¢ºç«‹
- ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼å¯¾å‡¦ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’æ¨™æº–åŒ–
- **æ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ä¸­æ–­æ™‚ã®å¾©æ—§æ‰‹é †ã‚’ç¢ºç«‹**
- **é–¢æ•°å®šç¾©å•é¡Œã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’æä¾›**

## ğŸš¨ é‡è¦ãªé‹ç”¨ä¸Šã®åˆ¶ç´„

### PowerShellç’°å¢ƒè¨­å®šã®å‰æ
- **PSReadLineè¨­å®š**: $PROFILEã§ç„¡åŠ¹åŒ–è¨­å®šæ¸ˆã¿ï¼ˆã“ã®ãƒ«ãƒ¼ãƒ«ã§ã¯æ‰±ã‚ãªã„ï¼‰
- **åŸºæœ¬ç’°å¢ƒ**: PowerShell 7.xç’°å¢ƒã§ã®å‹•ä½œã‚’å‰æ
- **ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹å®Ÿè¡Œ

### PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®æ¨™æº–è¨­å®š

#### AIå®Ÿè£…æ™‚ã®æ¨å¥¨åˆæœŸåŒ–æ‰‹é †
**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒPowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«å®Ÿè¡Œã™ã¹ãæ¨™æº–æ‰‹é †**ï¼š

```powershell
# === AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå°‚ç”¨åˆæœŸåŒ– ===
# 1. ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç¢ºèª
Get-Location

# 2. åŸºæœ¬å¤‰æ•°åˆæœŸåŒ–
$ErrorActionPreference = "Stop"  # ã‚¨ãƒ©ãƒ¼æ™‚å³åº§åœæ­¢

# 3. åˆæœŸåŒ–å®Œäº†ç¢ºèª
Write-Host "âœ… AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç”¨PowerShellåˆæœŸåŒ–å®Œäº†" -ForegroundColor Green
```

#### ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºå•é¡Œã®æ ¹æœ¬çš„è§£æ±º
**å¾“æ¥ã®å•é¡Œã¨æ–°ã—ã„è§£æ±ºç­–**ï¼š

```
å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:
âŒ ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæ‹¡å¼µ â†’ éƒ¨åˆ†çš„æ”¹å–„ï¼ˆæ ¹æœ¬è§£æ±ºã›ãšï¼‰
âŒ æ®µéšçš„åˆ†å‰²å®Ÿè¡Œ â†’ ä½œæ¥­åŠ¹ç‡ä½ä¸‹

æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:
âœ… PSReadLineç„¡åŠ¹åŒ– â†’ æ ¹æœ¬çš„è§£æ±º
âœ… AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœ€é©åŒ– â†’ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œ â†’ è¤‡é›‘ãªå›é¿ç­–ä¸è¦
```

### AIå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³å°‚ç”¨è¨­å®š

#### AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¤å®šã¨è‡ªå‹•è¨­å®š
**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ã®å®Ÿè¡Œã‚’è‡ªå‹•åˆ¤å®šã—ã¦è¨­å®šã‚’é©ç”¨**ï¼š

```powershell
# AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œç’°å¢ƒã®åˆ¤å®š
function Test-AIAgentEnvironment {
    # Cursorã‹ã‚‰ã®å®Ÿè¡Œã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œã®å ´åˆ
    if ($MyInvocation.Line -match "run_terminal_cmd|invoke|agent") {
        return $true
    }
    # éã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å®Ÿè¡Œã®å ´åˆ
    if (-not [Environment]::UserInteractive) {
        return $true
    }
    return $false
}

# è‡ªå‹•è¨­å®šé©ç”¨
if (Test-AIAgentEnvironment) {
    Remove-Module PSReadLine -Force -ErrorAction SilentlyContinue
    Write-Host "ğŸ¤– AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç’°å¢ƒã‚’æ¤œå‡ºã€PSReadLineç„¡åŠ¹åŒ–é©ç”¨" -ForegroundColor Cyan
}
```

#### å®Ÿè£…æ™‚ã®å„ªå…ˆé †ä½
**AIå®Ÿè£…æ™‚ã®è¨­å®šé©ç”¨å„ªå…ˆé †ä½**ï¼š

```
Priority 1: PSReadLineç„¡åŠ¹åŒ–ï¼ˆæ ¹æœ¬è§£æ±ºï¼‰
Priority 2: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­å®š
Priority 3: ä½œæ¥­åŠ¹ç‡åŒ–è¨­å®šï¼ˆæ®µéšçš„å®Ÿè¡Œç­‰ï¼‰
```

### å®Ÿè¨¼æ¸ˆã¿åŠ¹æœ

#### å•é¡Œè§£æ±ºã®å®Ÿè¨¼
**å®Ÿéš›ã«è§£æ±ºã•ã‚Œã‚‹å•é¡Œ**ï¼š
- âœ… **PSReadLine 2.3.6ã‚¨ãƒ©ãƒ¼**: `System.ArgumentOutOfRangeException` å®Œå…¨è§£æ¶ˆ
- âœ… **BufferHeight: 1å•é¡Œ**: ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®è¨ˆç®—ã‚¨ãƒ©ãƒ¼æ¶ˆå¤±
- âœ… **æ—¥æœ¬èªãƒ•ã‚¡ã‚¤ãƒ«åå•é¡Œ**: æ–‡å­—åŒ–ã‘ãƒ»è¡¨ç¤ºå´©ã‚Œè§£æ¶ˆ
- âœ… **é•·ã„ã‚³ãƒãƒ³ãƒ‰å•é¡Œ**: ã‚³ãƒãƒ³ãƒ‰é•·åˆ¶é™ã®å½±éŸ¿è»½æ¸›

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
**AIæ“ä½œã«ãŠã‘ã‚‹æ€§èƒ½æ”¹å–„**ï¼š
- âš¡ **å®Ÿè¡Œé€Ÿåº¦å‘ä¸Š**: PSReadLineã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰é™¤å»
- âš¡ **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å‰Šæ¸›**: ä¸è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é™¤å»
- âš¡ **ã‚¨ãƒ©ãƒ¼å‡¦ç†ç°¡ç´ åŒ–**: è¤‡é›‘ãªå›é¿ç­–ä¸è¦

### PowerShellé–¢æ•°ã®æ°¸ç¶šæ€§å•é¡Œã¨å¯¾å‡¦æ³•

#### å•é¡Œã®ç‰¹å®š
**ç—‡çŠ¶**: 
- å®šç¾©ã—ãŸé–¢æ•°ãŒã€Œã‚³ãƒãƒ³ãƒ‰ 'é–¢æ•°å' ãŒèªè­˜ã•ã‚Œã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼ã§å®Ÿè¡Œã§ããªã„
- è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã«é€”ä¸­ã§é–¢æ•°ãŒæ¶ˆå¤±ã™ã‚‹
- ã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã§é–¢æ•°å®šç¾©ãŒç¶­æŒã•ã‚Œãªã„

**åŸå› **: 
- PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«é–¢æ•°å®šç¾©ãŒæ¶ˆå¤±
- é•·ã„ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œä¸­ã®ãƒ¡ãƒ¢ãƒªå•é¡Œ
- ã‚¹ã‚³ãƒ¼ãƒ—è¨­å®šã®ä¸é©åˆ‡ã•

#### æ ¹æœ¬çš„è§£æ±ºç­–ï¼šã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–
**æœ€ã‚‚å®‰å®šã—ãŸå¯¾å‡¦æ³•**: `.ps1ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ + ãƒ‰ãƒƒãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°å®Ÿè¡Œ`

```powershell
# âŒ ä¸å®‰å®šãªæ–¹æ³•ï¼šã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§ã®é–¢æ•°å®šç¾©
function Test-Function { ... }  # ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†ã§æ¶ˆå¤±

# âœ… æ¨å¥¨æ–¹æ³•ï¼šã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–
# 1. ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆä¾‹ï¼šValidationScript.ps1ï¼‰
# 2. ãƒ‰ãƒƒãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã§èª­ã¿è¾¼ã¿
. .\script\ValidationScript.ps1
# 3. é–¢æ•°å®Ÿè¡Œ
Test-Function
```

#### ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

**ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ãƒ«ãƒ¼ãƒ«**:
- **å ´æ‰€**: `./script/` ãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã«é…ç½®
- **å‘½å**: æ©Ÿèƒ½ã‚’è¡¨ã™æ˜ç¢ºãªåå‰ï¼ˆä¾‹ï¼š`ObsidianToAnkiValidator.ps1`ï¼‰
- **æ¨©é™**: å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ã®ç¢ºèªï¼ˆå¿…è¦ã«å¿œã˜ã¦ `Set-ExecutionPolicy RemoteSigned`ï¼‰

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆæ‰‹é †**:
```powershell
# 1. scriptãƒ•ã‚©ãƒ«ãƒ€ä½œæˆï¼ˆå­˜åœ¨ã—ãªã„å ´åˆï¼‰
if (-not (Test-Path "script")) { mkdir script }

# 2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
@'
function Test-ObsidianToAnkiFile {
    param([string]$FilePath)
    # é–¢æ•°ã®å†…å®¹...
}

function Test-AllObsidianToAnkiFiles {
    # é–¢æ•°ã®å†…å®¹...
}

Write-Host "âœ… Obsidian_to_Ankiæ¤œè¨¼é–¢æ•°ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ" -ForegroundColor Green
'@ | Out-File -FilePath "script\ObsidianToAnkiValidator.ps1" -Encoding UTF8

# 3. ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿
. .\script\ObsidianToAnkiValidator.ps1

# 4. é–¢æ•°å®Ÿè¡Œ
Test-AllObsidianToAnkiFiles
```

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–ã®åˆ©ç‚¹**:
- âœ… **æ°¸ç¶šæ€§**: ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã‚‚é–¢æ•°å®šç¾©ãŒä¿æŒ
- âœ… **å†åˆ©ç”¨æ€§**: ä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚‚åŒã˜é–¢æ•°ã‚’ä½¿ç”¨å¯èƒ½
- âœ… **ä¿å®ˆæ€§**: é–¢æ•°ã®ä¿®æ­£ãƒ»æ‹¡å¼µãŒå®¹æ˜“
- âœ… **å…±æœ‰æ€§**: ãƒãƒ¼ãƒ å†…ã§ã®é–¢æ•°å…±æœ‰ãŒå¯èƒ½
- âœ… **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: Gitã§ã®å¤‰æ›´å±¥æ­´ç®¡ç†

#### ç·Šæ€¥æ™‚ã®ä»£æ›¿æ‰‹é †
ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–ãŒã§ããªã„å ´åˆã®ä¸€æ™‚çš„å¯¾å‡¦æ³•ï¼š

```powershell
# ä»£æ›¿æ‰‹é †1: Global ã‚¹ã‚³ãƒ¼ãƒ—ã§ã®é–¢æ•°å®šç¾©
function Global:Test-Function {
    param([string]$Parameter)
    # å‡¦ç†å†…å®¹
}

# ä»£æ›¿æ‰‹é †2: é–¢æ•°ã‚’ä½¿ã‚ãªã„ç›´æ¥ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
# å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªã®ä¾‹
$file = "target.md"
$content = Get-Content $file -Raw
if ($content -match "# Obsidian_to_Anki") {
    Write-Host "âœ… ã‚»ã‚¯ã‚·ãƒ§ãƒ³å­˜åœ¨: $file"
} else {
    Write-Host "âŒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸å­˜åœ¨: $file"
}
```

### æ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ä¸­æ–­æ™‚ã®å¯¾å¿œ
**å•é¡Œ**: ä¸€æ‹¬æ¤œè¨¼â†’è©³ç´°ç¢ºèªâ†’ä¿®æ­£â†’å†æ¤œè¨¼ã®æµã‚ŒãŒä¸­æ–­ã•ã‚Œã‚‹
**å¯¾å‡¦**:
1. **ç¾çŠ¶æŠŠæ¡**: ä¸­æ–­æ™‚ç‚¹ã§ã®å•é¡Œãƒ•ã‚¡ã‚¤ãƒ«ç‰¹å®š
2. **ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†èª­ã¿è¾¼ã¿**: `. .\script\ã‚¹ã‚¯ãƒªãƒ—ãƒˆå.ps1`
3. **éƒ¨åˆ†æ¤œè¨¼**: å•é¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®å€‹åˆ¥ç¢ºèª
4. **ç¶™ç¶šå®Ÿè¡Œ**: æœªå‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®å†é–‹

### AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç’°å¢ƒã§ã®ç‰¹åˆ¥åˆ¶ç´„

#### è¤‡æ•°è¡Œé–¢æ•°å®šç¾©ã®å®Œå…¨åœæ­¢å•é¡Œï¼ˆé‡è¦ï¼‰
**ç—‡çŠ¶**: 
- è¤‡æ•°è¡ŒPowerShellé–¢æ•°å®šç¾©ã§ã€ŒCommand popped out into background by the userã€ã‚¨ãƒ©ãƒ¼
- é–¢æ•°å®šç¾©ã‚³ãƒãƒ³ãƒ‰ãŒé€”ä¸­ã§å®Œå…¨åœæ­¢ï¼ˆï½20è¡Œã®é–¢æ•°å®šç¾©ã§100%å†ç¾ï¼‰
- ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆ`| Out-String`ï¼‰ä½¿ç”¨ã§ã‚‚åœæ­¢

**åŸå› **: 
- Cursorã®AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œç’°å¢ƒã®å‡¦ç†åˆ¶é™
- è¤‡æ•°è¡Œæ§‹æ–‡ã®è§£æå‡¦ç†ã§ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼
- PSReadLineç„¡åŠ¹åŒ–æ¸ˆã¿ç’°å¢ƒã§ã‚‚ç™ºç”Ÿã™ã‚‹æ ¹æœ¬çš„åˆ¶é™

**æ¤œè¨¼æ¸ˆã¿äº‹å®Ÿ**:
```powershell
# âŒ 100%åœæ­¢ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³
function Get-GitChangesSummary {
    param([int]$CommitRange = 1)
    # è¤‡æ•°è¡Œã®å‡¦ç†...
}

# âŒ ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ã‚‚åœæ­¢
function Test-Function { ... } | Out-String

# âœ… 100%æˆåŠŸã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæ®µéšçš„åˆ†å‰²å®Ÿè¡Œï¼‰
Write-Host "=== Gitå¤‰æ›´å†…å®¹ã‚µãƒãƒªãƒ¼ ===" -ForegroundColor Cyan
$changedFiles = git --no-pager diff --name-only HEAD~1 HEAD
Write-Host "å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ•°: $($changedFiles.Count)" -ForegroundColor Green
$changedFiles | ForEach-Object { Write-Host "  - $_" -ForegroundColor Yellow }
```

**è§£æ±ºç­–**: 
1. **æ®µéšçš„åˆ†å‰²å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰**: å˜ä¸€è¡Œã‚³ãƒãƒ³ãƒ‰ã®çµ„ã¿åˆã‚ã›ã§åŒç­‰æ©Ÿèƒ½ã‚’å®Ÿç¾
2. **ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–**: å¤–éƒ¨.ps1ãƒ•ã‚¡ã‚¤ãƒ«ã§ã®é–¢æ•°å®šç¾© + ãƒ‰ãƒƒãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°
3. **ç›´æ¥ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**: é–¢æ•°ã‚’ä½¿ã‚ãšã«å€‹åˆ¥ã‚³ãƒãƒ³ãƒ‰ã§å‡¦ç†

**âŒ å‹•ä½œã—ãªã„æ–¹æ³•ï¼ˆæ¤œè¨¼æ¸ˆã¿ï¼‰**:
- Here-Stringæ–¹å¼ï¼ˆ`@' '@`ï¼‰ã‚‚åŒæ§˜ã«ãƒ•ãƒªãƒ¼ã‚ºã™ã‚‹
- è¤‡æ•°è¡Œé–¢æ•°å®šç¾©ã¯æ§‹æ–‡ã«é–¢ã‚ã‚‰ãšå…¨ã¦åœæ­¢

**ä»Šå›ã®å®Ÿè¨¼äº‹ä¾‹ï¼ˆ2025-07-02æ¤œè¨¼ï¼‰**:
- **å•é¡Œ**: Obsidian-to-Ankiãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§CRLFæ”¹è¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒèªè­˜ã•ã‚Œãªã„
- **åŸå› **: `turn-ones-back-on-è¦‹æ¨ã¦ã‚‹.md`ãƒ•ã‚¡ã‚¤ãƒ«ã«CRLFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒæ··åœ¨
- **è§£æ±º**: æ®µéšçš„åˆ†å‰²å®Ÿè¡Œã«ã‚ˆã‚‹CRLFâ†’LFå¤‰æ›ã§å®Œå…¨è§£æ±º
- **æ¤œè¨¼çµæœ**: Here-Stringæ–¹å¼ã‚‚é–¢æ•°å®šç¾©ã¨åŒæ§˜ã«100%ãƒ•ãƒªãƒ¼ã‚ºã™ã‚‹ã“ã¨ã‚’ç¢ºèª

#### ãƒ•ãƒªãƒ¼ã‚ºæ™‚ã®è‡ªå‹•å¾©æ—§æ–¹æ³•

**ç—‡çŠ¶ã®è¦‹åˆ†ã‘æ–¹**:
```powershell
# ãƒ•ãƒªãƒ¼ã‚ºçŠ¶æ…‹ï¼ˆ>> ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒç¶šãï¼‰
PS> function Test-Function {
>>     param([string]$FilePath)
>>     # ã“ã®çŠ¶æ…‹ã§å…¥åŠ›å¾…ã¡
>>
```

**è‡ªå‹•å¾©æ—§æ‰‹é †**:
```powershell
# æ–¹æ³•1: æ®µéšçš„åˆ†å‰²å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
# é–¢æ•°ã‚’ä½¿ã‚ãšã«ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã§åŒç­‰æ©Ÿèƒ½ã‚’å®Ÿç¾
Write-Host "=== æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯é–‹å§‹ ===" -ForegroundColor Cyan
$file = "target.md"
$bytes = [System.IO.File]::ReadAllBytes($file)
$hasCRLF = $false; $hasLF = $false
for ($i = 0; $i -lt $bytes.Length - 1; $i++) {
    if ($bytes[$i] -eq 0x0D -and $bytes[$i + 1] -eq 0x0A) { $hasCRLF = $true; break }
    elseif ($bytes[$i] -eq 0x0A) { $hasLF = $true; break }
}
if ($hasCRLF) { Write-Host "CRLFæ¤œå‡º" -ForegroundColor Red } else { Write-Host "LFç¢ºèª" -ForegroundColor Green }

# æ–¹æ³•2: CRLFâ†’LFå¤‰æ›ï¼ˆå®Ÿè¨¼æ¸ˆã¿æˆåŠŸä¾‹ï¼‰
$content = Get-Content $file -Raw
$contentLF = $content -replace "`r`n", "`n"
$utf8NoBom = New-Object System.Text.UTF8Encoding($false)
[System.IO.File]::WriteAllText($file, $contentLF, $utf8NoBom)
Write-Host "CRLFâ†’LFå¤‰æ›å®Œäº†" -ForegroundColor Green

# æ–¹æ³•3: å¼·åˆ¶çµ‚äº† + æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆç·Šæ€¥æ™‚ï¼‰
# Ctrl+Cç›¸å½“ã®å‡¦ç†ã‚’è¡Œã„ã€æ–°ã—ã„PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹
```

**ãƒ•ãƒªãƒ¼ã‚ºäºˆé˜²ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ**:
- [ ] **è¤‡æ•°è¡Œæ§‹æ–‡ã‚’ä¸€åˆ‡ä½¿ç”¨ã—ãªã„**ï¼ˆfunctionå®šç¾©ã€Here-Stringç­‰ï¼‰
- [ ] å˜ä¸€è¡Œã‚³ãƒãƒ³ãƒ‰ã®çµ„ã¿åˆã‚ã›ã§æ©Ÿèƒ½ã‚’å®Ÿç¾
- [ ] è¤‡é›‘ãªå‡¦ç†ã¯æ®µéšçš„åˆ†å‰²å®Ÿè¡Œã‚’é¸æŠ
- [ ] é–¢æ•°ãŒå¿…è¦ãªå ´åˆã¯å¤–éƒ¨.ps1ãƒ•ã‚¡ã‚¤ãƒ«åŒ–ã‚’æœ€å„ªå…ˆ

**åŠ¹æœ**: 
- âœ… é–¢æ•°ã¨åŒç­‰ã®æ©Ÿèƒ½ã‚’ç¢ºå®Ÿã«å®Ÿç¾
- âœ… AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç’°å¢ƒã§ã®100%å‹•ä½œä¿è¨¼
- âœ… ãƒ•ãƒªãƒ¼ã‚ºçŠ¶æ…‹ã‹ã‚‰ã®è‡ªå‹•å¾©æ—§æ©Ÿèƒ½
- âœ… ãƒ‡ãƒãƒƒã‚°ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®ç°¡ç´ åŒ–

## ã‚³ãƒãƒ³ãƒ‰é•·åˆ¶é™å•é¡Œ

### åˆ¶é™å€¤ã¨äº‹å‰ãƒã‚§ãƒƒã‚¯
**PowerShellã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³åˆ¶é™**: ç´„8192æ–‡å­—ï¼ˆ8KBï¼‰
**æ¨å¥¨ä¸Šé™**: 6000æ–‡å­—ï¼ˆå®‰å…¨ãƒãƒ¼ã‚¸ãƒ³è€ƒæ…®ï¼‰
**å±é™ºé ˜åŸŸ**: 5000æ–‡å­—ä»¥ä¸Šã§åˆ†å‰²æ¤œè¨

**äº‹å‰ãƒã‚§ãƒƒã‚¯æ–¹æ³•**:
```powershell
# ã‚³ãƒãƒ³ãƒ‰é•·ãƒã‚§ãƒƒã‚¯é–¢æ•°
function Test-CommandLength {
    param([string]$Command)
    $length = $Command.Length
    if ($length -gt 6000) {
        Write-Warning "ã‚³ãƒãƒ³ãƒ‰é•· $length æ–‡å­—: åˆ†å‰²å®Ÿè¡Œã‚’æ¨å¥¨"
        return $false
    } elseif ($length -gt 5000) {
        Write-Warning "ã‚³ãƒãƒ³ãƒ‰é•· $length æ–‡å­—: æ³¨æ„ãŒå¿…è¦"
        return $true
    } else {
        Write-Host "ã‚³ãƒãƒ³ãƒ‰é•· $length æ–‡å­—: å•é¡Œãªã—" -ForegroundColor Green
        return $true
    }
}
```

### å•é¡Œã®ç‰¹å®š
**ç—‡çŠ¶**: é•·ã„ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãŒå®Ÿè¡Œã§ããªã„ã€ã‚³ãƒãƒ³ãƒ‰ãŒé€”ä¸­ã§åˆ‡ã‚Œã‚‹
**åŸå› **: PowerShellã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³é•·åˆ¶é™ã€è¤‡é›‘ãªæ§‹æ–‡ã«ã‚ˆã‚‹è§£æã‚¨ãƒ©ãƒ¼

### AIå®Ÿè£…æ™‚ã®è‡ªå‹•é¸æŠåŸºæº–
**ã‚³ãƒãƒ³ãƒ‰ç”Ÿæˆæ™‚ã®åˆ¤å®šãƒ•ãƒ­ãƒ¼ï¼ˆå¿…é ˆï¼‰**:
1. **ã‚³ãƒãƒ³ãƒ‰é•·æ¸¬å®š**: ç”Ÿæˆã—ãŸã‚³ãƒãƒ³ãƒ‰ã®æ–‡å­—æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
2. **åˆ¶é™ãƒã‚§ãƒƒã‚¯**: 6000æ–‡å­—ã‚’è¶…ãˆã‚‹å ´åˆã¯è‡ªå‹•çš„ã«åˆ†å‰²æ–¹å¼ã‚’é¸æŠ
3. **ä»£æ›¿æ‰‹æ³•é¸æŠ**: ä»¥ä¸‹ã®å„ªå…ˆé †ä½ã§ä»£æ›¿æ¡ˆã‚’å®Ÿè£…
   - æ®µéšçš„åˆ†å‰²å®Ÿè¡Œï¼ˆå¤‰æ•°ä½¿ç”¨ï¼‰
   - here-stringå›é¿ï¼ˆæ–‡å­—åˆ—é€£çµä½¿ç”¨ï¼‰
   - ç°¡ç•¥ç‰ˆã‚³ãƒãƒ³ãƒ‰ä½¿ç”¨
   - ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›çµŒç”±ã®å‡¦ç†

**AIå®Ÿè£…æ™‚ã®å¿…é ˆãƒã‚§ãƒƒã‚¯é …ç›®**:
```
â˜‘ï¸ PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæ‹¡å¼µã‚’å®Ÿè¡Œ
â˜‘ï¸ ã‚³ãƒãƒ³ãƒ‰é•·ãŒ6000æ–‡å­—ä»¥ä¸‹ã‹ç¢ºèª
â˜‘ï¸ è¶…éæ™‚ã¯ä¸Šè¨˜ä»£æ›¿æ‰‹æ³•ã‚’è‡ªå‹•é©ç”¨
â˜‘ï¸ é–¢æ•°å®šç¾©ãŒå¿…è¦ãªå ´åˆã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–ã‚’æœ€å„ªå…ˆ
â˜‘ï¸ æ®µéšçš„åˆ†å‰²å®Ÿè¡Œã€é–¢æ•°å®šç¾©ã€ãƒ•ã‚¡ã‚¤ãƒ«çµŒç”±ã®å„ªå…ˆé †ä½ã§é¸æŠ
```

**PowerShellé–¢æ•°å®šç¾©å•é¡Œã®å¯¾å‡¦ï¼ˆAIå®Ÿè£…æ™‚å¿…é ˆï¼‰**:
- é–¢æ•°å®šç¾©ãŒå¿…è¦ãªå ´åˆã¯ **ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åŒ–ã‚’æœ€å„ªå…ˆ** ã§å®Ÿè£…
- é–¢æ•°ãŒèªè­˜ã•ã‚Œãªã„å ´åˆã¯å³åº§ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.ps1`ï¼‰ä½œæˆã‚’ææ¡ˆ
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ `./script/` ãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã«é…ç½®
- è©³ç´°ãªæ‰‹é †ã¯ä¸‹è¨˜ã€ŒPowerShellé–¢æ•°ã®æ°¸ç¶šæ€§å•é¡Œã¨å¯¾å‡¦æ³•ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§

### å¯¾å‡¦æ³•ï¼šæ®µéšçš„åˆ†å‰²å®Ÿè¡Œ
```powershell
# âŒ é•·ã™ãã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼ˆå®Ÿè¡Œå¤±æ•—ï¼‰
$content = [System.IO.File]::ReadAllBytes("ãƒ•ã‚¡ã‚¤ãƒ«å.md"); $endIndex = $content.Length - 10; for ($i = $endIndex; $i -lt $content.Length; $i++) { $char = $content[$i]; $hex = "{0:X2}" -f $char; $ascii = if ($char -ge 32 -and $char -le 126) { [char]$char } else { "." }; Write-Host "$i : $hex ($ascii)" }

# âœ… åˆ†å‰²å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
# Step 1: ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
$content = [System.IO.File]::ReadAllBytes("ãƒ•ã‚¡ã‚¤ãƒ«å.md")

# Step 2: ç¯„å›²è¨­å®š
$endIndex = $content.Length - 10

# Step 3: ãƒ«ãƒ¼ãƒ—å®Ÿè¡Œ
for ($i = $endIndex; $i -lt $content.Length; $i++) {
    $char = $content[$i]
    $hex = "{0:X2}" -f $char
    $ascii = if ($char -ge 32 -and $char -le 126) { [char]$char } else { "." }
    Write-Host "$i : $hex ($ascii)"
}
```

## ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼å¯¾å‡¦æ³•

### PSReadLineã‚¨ãƒ©ãƒ¼
**å•é¡Œ**: here-string (@'...'@) ä½¿ç”¨æ™‚ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºå´©ã‚Œ
**ç—‡çŠ¶**: `System.ArgumentOutOfRangeException` ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒãƒƒãƒ•ã‚¡ã‚¨ãƒ©ãƒ¼
**æ ¹æœ¬åŸå› **: ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºä¸è¶³ï¼ˆç‰¹ã« `BufferHeight: 1` çŠ¶æ…‹ï¼‰

#### åŸºæœ¬å¯¾å‡¦æ³•ï¼šãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæ‹¡å¼µï¼ˆæ¨å¥¨ï¼‰
```powershell
# âœ… æœ€ã‚‚åŠ¹æœçš„ãªè§£æ±ºç­–ï¼šã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«å®Ÿè¡Œ
$host.UI.RawUI.BufferSize = New-Object Management.Automation.Host.Size (120, 3000)

# è¨­å®šç¢ºèª
$host.UI.RawUI.BufferSize  # Width: 120, Height: 3000 ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸ

# ã“ã®è¨­å®šã«ã‚ˆã‚Šä»¥ä¸‹ãŒè§£æ±ºï¼š
# - here-stringä½¿ç”¨æ™‚ã®ã‚¨ãƒ©ãƒ¼
# - è¤‡é›‘ãªã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼
# - æ—¥æœ¬èªã‚­ãƒ¼ã®ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œã‚¨ãƒ©ãƒ¼
```

#### ä»£æ›¿å¯¾å‡¦æ³•ï¼šã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®ç¶™ç¶šå‡¦ç†
**é‡è¦ãªå¯¾å‡¦æ³•**: **ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã¯é€šå¸¸æˆåŠŸã—ã¦ã„ã‚‹**

```powershell
# ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿä¾‹
@'
å¤§é‡ã®ãƒ†ã‚­ã‚¹ãƒˆ...
'@ | Out-File -FilePath "ãƒ•ã‚¡ã‚¤ãƒ«å.md" -Encoding UTF8

# ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªã‚’ç¶™ç¶š
$bytes = [System.IO.File]::ReadAllBytes("ãƒ•ã‚¡ã‚¤ãƒ«å.md")
$bytes[-5..-1] | ForEach-Object { "{0:X2} ({1})" -f $_, [char]$_ }
```

#### ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¥å¯¾å‡¦
**ãƒ‘ã‚¿ãƒ¼ãƒ³1**: `System.ArgumentOutOfRangeException: BufferHeight: 1`
- **å¯¾å‡¦**: ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæ‹¡å¼µï¼ˆä¸Šè¨˜ã®åŸºæœ¬å¯¾å‡¦æ³•ï¼‰

**ãƒ‘ã‚¿ãƒ¼ãƒ³2**: here-stringä½¿ç”¨æ™‚ã®è¡¨ç¤ºå´©ã‚Œ
- **å¯¾å‡¦**: ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæ‹¡å¼µ + ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ç¢ºèªç¶™ç¶š

**ãƒ‘ã‚¿ãƒ¼ãƒ³3**: è¤‡é›‘ãªã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼
- **å¯¾å‡¦**: ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæ‹¡å¼µ + æ®µéšçš„åˆ†å‰²å®Ÿè¡Œ

### ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºå•é¡Œã®å›é¿ç­–
1. **çŸ­ã„ã‚³ãƒãƒ³ãƒ‰ã«åˆ†å‰²**: è¤‡é›‘ãªå‡¦ç†ã‚’æ®µéšçš„ã«å®Ÿè¡Œ
2. **ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ç¢ºèª**: ã‚¨ãƒ©ãƒ¼å¾Œã‚‚çµæœãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèªã‚’å®Ÿæ–½
3. **ãƒã‚¤ãƒŠãƒªç¢ºèª**: ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºã§ãªããƒã‚¤ãƒŠãƒªãƒ¬ãƒ™ãƒ«ã§ã®ç¢ºèª
4. **ãƒšãƒ¼ã‚¸ãƒ£ãƒ¼å›é¿**: `git config --global core.pager cat` ã§æ ¹æœ¬è§£æ±º

## æ–‡å­—ã‚³ãƒ¼ãƒ‰ç¢ºèªã®æ¨™æº–æ‰‹é †

### åŸºæœ¬çš„ãªæ–‡å­—ã‚³ãƒ¼ãƒ‰ç¢ºèª
```powershell
# ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã®ãƒã‚¤ãƒŠãƒªèª­ã¿è¾¼ã¿
$content = [System.IO.File]::ReadAllBytes("ãƒ•ã‚¡ã‚¤ãƒ«å.md")

# æœ«å°¾10ãƒã‚¤ãƒˆã®ç¢ºèª
$endIndex = $content.Length - 10
for ($i = $endIndex; $i -lt $content.Length; $i++) {
    $char = $content[$i]
    $hex = "{0:X2}" -f $char
    $ascii = if ($char -ge 32 -and $char -le 126) { [char]$char } else { "." }
    Write-Host "$i : $hex ($ascii)"
}
```

### ç°¡ç•¥ç‰ˆï¼ˆæœ«å°¾ç¢ºèªï¼‰
```powershell
# æœ«å°¾5ãƒã‚¤ãƒˆã®ã¿ç¢ºèª
$bytes = [System.IO.File]::ReadAllBytes("ãƒ•ã‚¡ã‚¤ãƒ«å.md")
$bytes[-5..-1] | ForEach-Object { "{0:X2} ({1})" -f $_, [char]$_ }
```

### æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ··åœ¨ç¢ºèª
```powershell
# ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ç¢ºèª
$content = Get-Content "ãƒ•ã‚¡ã‚¤ãƒ«å.md" -Raw
$lf = ($content | Select-String -Pattern "`n" -AllMatches).Matches.Count
Write-Host "LF: $lf, CRLF: $crlf"
```

### ENDãƒãƒ¼ã‚«ãƒ¼ä½ç½®ç‰¹å®šã¨æ¤œè¨¼
```powershell
# ENDãƒãƒ¼ã‚«ãƒ¼ã®ä½ç½®ã‚’ç‰¹å®šã—ã€ãã®å¾Œã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
$content = Get-Content "ãƒ•ã‚¡ã‚¤ãƒ«å.md" -Raw
$endPattern = "END"
$endIndex = $content.LastIndexOf($endPattern)

if ($endIndex -ge 0) {
    Write-Host "ENDãƒãƒ¼ã‚«ãƒ¼ä½ç½®: $endIndex"
    $afterEndStart = $endIndex + $endPattern.Length
    $afterEnd = $content.Substring($afterEndStart, [Math]::Min(10, $content.Length - $afterEndStart))
    
    # ENDã®å¾Œã®æ–‡å­—ã‚’16é€²æ•°ã§ç¢ºèª
    $bytes = [System.Text.Encoding]::UTF8.GetBytes($afterEnd)
    for ($i = 0; $i -lt $bytes.Length; $i++) {
        $char = $bytes[$i]
        $hex = "{0:X2}" -f $char
        $ascii = if ($char -ge 32 -and $char -le 126) { [char]$char } else { "." }
        Write-Host "END+$($i+1): $hex ($ascii)"
    }
} else {
    Write-Host "ENDãƒãƒ¼ã‚«ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
}
```

### æ±ç”¨çš„ãªæ–‡å­—ã‚³ãƒ¼ãƒ‰ç¢ºèª
```powershell
# ç‰¹å®šä½ç½®ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ç¢ºèªï¼ˆ16é€²æ•°è¡¨ç¤ºï¼‰
function Get-ByteAnalysis {
    param(
        [string]$FilePath,
        [int]$StartIndex = 0,
        [int]$Length = 10
    )
    
    if (-not (Test-Path $FilePath)) {
        Write-Host "âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“: $FilePath" -ForegroundColor Red
        return
    }
    
    $content = Get-Content $FilePath -Raw
    $endIndex = [Math]::Min($StartIndex + $Length, $content.Length)
    
    Write-Host "=== ãƒã‚¤ãƒˆåˆ†æ: $FilePath ===" -ForegroundColor Cyan
    Write-Host "ä½ç½® $StartIndex - $($endIndex-1):" -ForegroundColor Cyan
    
    for ($i = $StartIndex; $i -lt $endIndex; $i++) {
        if ($i -lt $content.Length) {
            $char = $content[$i]
            $byte = [System.Text.Encoding]::UTF8.GetBytes($char)[0]
            $hex = "{0:X2}" -f $byte
            $display = if ($byte -ge 32 -and $byte -le 126) { $char } else { "." }
            
            $status = switch ($hex) {
                "0D" { "CR" }
                "0A" { "LF" }
                "20" { "SP" }
                default { $display }
            }
            
            Write-Host "$i : $hex ($status)"
        }
    }
}

# ä½¿ç”¨ä¾‹: ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾10æ–‡å­—ã‚’ç¢ºèª
# $content = Get-Content "example.txt" -Raw
# Get-ByteAnalysis "example.txt" -StartIndex ($content.Length - 10) -Length 10
```

## æ±ç”¨çš„ãªæ¤œè¨¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ç¢ºèª
```powershell
# ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰çŠ¶æ³ã‚’ç¢ºèª
function Test-FileEnding {
    param([string]$FilePath)
    
    if (-not (Test-Path $FilePath)) {
        Write-Host "âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“: $FilePath" -ForegroundColor Red
        return
    }
    
    $content = Get-Content $FilePath -Raw
    $length = $content.Length
    
    Write-Host "=== ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ç¢ºèª: $FilePath ===" -ForegroundColor Cyan
    Write-Host "ãƒ•ã‚¡ã‚¤ãƒ«é•·: $length æ–‡å­—" -ForegroundColor Cyan
    
    if ($length -eq 0) {
        Write-Host "âš ï¸ ç©ºãƒ•ã‚¡ã‚¤ãƒ«" -ForegroundColor Yellow
        return
    }
    
    # æœ«å°¾5æ–‡å­—ã‚’ç¢ºèª
    $endStart = [Math]::Max(0, $length - 5)
    $endContent = $content.Substring($endStart)
    $bytes = [System.Text.Encoding]::UTF8.GetBytes($endContent)
    
    Write-Host "æœ«å°¾5æ–‡å­—ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰:" -ForegroundColor Cyan
    for ($i = 0; $i -lt $bytes.Length; $i++) {
        $char = $bytes[$i]
        $hex = "{0:X2}" -f $char
        $ascii = if ($char -ge 32 -and $char -le 126) { [char]$char } else { "." }
        
        $status = switch ($hex) {
            "0D" { "CR" }
            "0A" { "LF" }
            "20" { "SP" }
            default { $ascii }
        }
        
        Write-Host "  $($endStart + $i): $hex ($status)"
    }
    
    # æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ¤å®š
    $endBytes = $bytes[-2..-1]  # æœ«å°¾2ãƒã‚¤ãƒˆ
    if ($endBytes.Length -ge 2 -and $endBytes[-2] -eq 0x0D -and $endBytes[-1] -eq 0x0A) {
        Write-Host "âœ… LF ã§çµ‚äº†" -ForegroundColor Green
    } elseif ($endBytes.Length -ge 1 -and $endBytes[-1] -eq 0x0A) {
        Write-Host "âš ï¸ LF ã®ã¿ã§çµ‚äº†" -ForegroundColor Yellow
    } elseif ($endBytes.Length -ge 1 -and $endBytes[-1] -eq 0x0D) {
        Write-Host "âš ï¸ CR ã®ã¿ã§çµ‚äº†" -ForegroundColor Yellow
    } else {
        Write-Host "âš ï¸ æ”¹è¡Œãªã—ã§çµ‚äº†" -ForegroundColor Yellow
    }
}

# ä½¿ç”¨ä¾‹
# Test-FileEnding "example.txt"
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æ¤œè¨¼
```powershell
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æ¤œè¨¼ãŒå¿…è¦ãªå ´åˆã¯ã€
# é©åˆ‡ãªå°‚ç”¨ãƒ«ãƒ¼ãƒ«ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š
# - [[110-PowerShellæ“ä½œç®¡ç†.mdc]] - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±é€šæ“ä½œï¼ˆæ—§103çµ±åˆï¼‰
# - [[203-Obsidian_to_Ankiå°‚ç”¨PowerShellæ“ä½œ.mdc]] - Obsidian_to_Ankiå°‚ç”¨æ“ä½œ
```

## ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çµ±ä¸€
```powershell
# UTF-8ï¼ˆBOMãªã—ï¼‰ã§ã®å‡ºåŠ›
$content | Out-File -FilePath "ãƒ•ã‚¡ã‚¤ãƒ«å.md" -Encoding UTF8

# UTF-8ã§ã®èª­ã¿è¾¼ã¿
$content = Get-Content "ãƒ•ã‚¡ã‚¤ãƒ«å.md" -Encoding UTF8 -Raw
```

### æ”¹è¡Œã‚³ãƒ¼ãƒ‰çµ±ä¸€

#### åŸºæœ¬çš„ãªLFçµ±ä¸€ï¼ˆå¾“æ¥æ–¹å¼ï¼‰
```powershell
# LFçµ±ä¸€
$content = Get-Content $FilePath -Raw
$content = $content -replace "`r`n", "`n"  # LFã«çµ±ä¸€
Set-Content $FilePath -Value $content -NoNewline -Encoding UTF8
```

#### PowerShellãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†å¾Œã®æ¨™æº–æ‰‹é †ï¼ˆæ¨å¥¨ï¼‰
**PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆãƒ»ç·¨é›†ã—ãŸå¾Œã¯å¿…ãšå®Ÿè¡Œ**

```powershell
# === æ”¹è¡Œã‚³ãƒ¼ãƒ‰ä¿®æ­£ã®æ¨™æº–æ‰‹é † ===
# PowerShellã§ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†å¾Œã®å¿…é ˆæ“ä½œ

# å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£
function Fix-LineEndings {
    param([string]$FilePath)
    
    if (-not (Test-Path $FilePath)) {
        Write-Host "âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“: $FilePath" -ForegroundColor Red
        return
    }
    
    $content = (Get-Content $FilePath -Raw) -replace "`r`n", "`n"
    $utf8NoBom = New-Object System.Text.UTF8Encoding($false)
    [System.IO.File]::WriteAllText($FilePath, $content, $utf8NoBom)
    
    Write-Host "âœ… æ”¹è¡Œã‚³ãƒ¼ãƒ‰ä¿®æ­£å®Œäº†: $FilePath" -ForegroundColor Green
}

# è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬ä¿®æ­£
function Fix-AllMarkdownLineEndings {
    $mdFiles = Get-ChildItem -Path "." -Filter "*.md" | Where-Object { $_.Name -notlike "README.md" }
    
    Write-Host "=== Markdownãƒ•ã‚¡ã‚¤ãƒ«æ”¹è¡Œã‚³ãƒ¼ãƒ‰ä¸€æ‹¬ä¿®æ­£ ===" -ForegroundColor Cyan
    Write-Host "å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: $($mdFiles.Count)" -ForegroundColor Cyan
    
    foreach ($file in $mdFiles) {
        $content = (Get-Content $file.FullName -Raw) -replace "`r`n", "`n"
        $utf8NoBom = New-Object System.Text.UTF8Encoding($false)
        [System.IO.File]::WriteAllText($file.FullName, $content, $utf8NoBom)
        Write-Host "  âœ“ $($file.Name)" -ForegroundColor Green
    }
    
    Write-Host "âœ… å…¨ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£å®Œäº†" -ForegroundColor Green
}

# ä½¿ç”¨ä¾‹ï¼š
# Fix-LineEndings -FilePath "ãƒ•ã‚¡ã‚¤ãƒ«å.md"
# Fix-AllMarkdownLineEndings
```

#### ä¿®æ­£ãŒå¿…è¦ã«ãªã‚‹å ´é¢
**PowerShellã§ä»¥ä¸‹ã®å‡¦ç†ã‚’è¡Œã£ãŸå¾Œã¯æ”¹è¡Œã‚³ãƒ¼ãƒ‰ä¿®æ­£ãŒå¿…é ˆ**ï¼š

1. **ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ç³»ã‚³ãƒãƒ³ãƒ‰ä½¿ç”¨æ™‚**
   ```powershell
   # ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ä½¿ç”¨å¾Œã¯å¿…ãšä¿®æ­£
   Out-File, Set-Content, Add-Content, >, >>
   ```

2. **Here-Stringä½¿ç”¨æ™‚**
   ```powershell
   @'
   ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
   '@ | Out-File "file.md" -Encoding UTF8
   # â†“ å¿…é ˆ
   Fix-LineEndings -FilePath "file.md"
   ```

3. **ãƒ—ãƒ­ã‚°ãƒ©ãƒ ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆæ™‚**
   ```powershell
   # ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§Markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ãŸå ´åˆ
   $content = "# ã‚¿ã‚¤ãƒˆãƒ«`n`nå†…å®¹"
   $content | Out-File "generated.md" -Encoding UTF8
   # â†“ å¿…é ˆ
   Fix-LineEndings -FilePath "generated.md"
   ```

#### å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®åŸå‰‡
- **ä½œæ¥­å®Œäº†ç›´å¾Œ**: PowerShellã§ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã—ãŸç›´å¾Œ
- **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Ÿè¡Œå‰**: Obsidian to Ankiãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Ÿè¡Œå‰
- **Gitæ“ä½œå‰**: ã‚³ãƒŸãƒƒãƒˆå‰ã®æœ€çµ‚ç¢ºèªã¨ã—ã¦
- **å•é¡Œç™ºç”Ÿæ™‚**: æ­£è¦è¡¨ç¾ãƒãƒƒãƒãƒ³ã‚°ãŒå¤±æ•—ã—ãŸå ´åˆ

## ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾å‡¦æ³•

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ã‚³ãƒãƒ³ãƒ‰é•·åˆ¶é™
**ç—‡çŠ¶**: ã‚³ãƒãƒ³ãƒ‰ãŒé€”ä¸­ã§åˆ‡ã‚Œã‚‹
**å¯¾å‡¦**: æ®µéšçš„åˆ†å‰²å®Ÿè¡Œ

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: PSReadLineã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤ºå´©ã‚Œã€ArgumentOutOfRangeException
**å¯¾å‡¦**: ã‚¨ãƒ©ãƒ¼ç„¡è¦–ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªç¶™ç¶š

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å•é¡Œ
**ç—‡çŠ¶**: æ–‡å­—åŒ–ã‘ã€BOMä»˜ããƒ•ã‚¡ã‚¤ãƒ«
**å¯¾å‡¦**: UTF-8çµ±ä¸€ã€BOMé™¤å»

### ãƒ‘ã‚¿ãƒ¼ãƒ³4: æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ··åœ¨
**ç—‡çŠ¶**: æ­£è¦è¡¨ç¾ãƒãƒƒãƒãƒ³ã‚°å¤±æ•—
**å¯¾å‡¦**: LFçµ±ä¸€å‡¦ç†

## äºˆé˜²ç­–

### ã‚³ãƒãƒ³ãƒ‰ä½œæˆæ™‚ã®æ³¨æ„ç‚¹
1. **é•·ã„ã‚³ãƒãƒ³ãƒ‰ã®å›é¿**: è¤‡é›‘ãªå‡¦ç†ã¯åˆ†å‰²ã—ã¦è¨˜è¿°
2. **ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ˜ç¤º**: å¸¸ã« `-Encoding UTF8` ã‚’æŒ‡å®š
3. **æ”¹è¡Œã‚³ãƒ¼ãƒ‰çµ±ä¸€**: LF ã‚’åŸºæœ¬ã¨ã™ã‚‹

### ãƒ‡ãƒãƒƒã‚°æ™‚ã®ç¢ºèªæ‰‹é †
1. **ã‚¨ãƒ©ãƒ¼å†…å®¹ã®ç¢ºèª**: PSReadLineã‚¨ãƒ©ãƒ¼ã‹ã‚³ãƒãƒ³ãƒ‰ã‚¨ãƒ©ãƒ¼ã‹ã‚’åˆ¤åˆ¥
2. **ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ç¢ºèª**: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ç”ŸæˆçŠ¶æ³ã‚’ç¢ºèª
3. **ãƒã‚¤ãƒŠãƒªãƒ¬ãƒ™ãƒ«ç¢ºèª**: æ–‡å­—ã‚³ãƒ¼ãƒ‰å•é¡Œã¯16é€²æ•°ã§ç¢ºèª

## é–¢é€£ãƒ„ãƒ¼ãƒ«ãƒ»ã‚³ãƒãƒ³ãƒ‰

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰
- `[System.IO.File]::ReadAllBytes()`: ãƒã‚¤ãƒŠãƒªãƒ¬ãƒ™ãƒ«ã§ã®æ–‡å­—ç¢ºèª
- `Get-Content -Raw`: ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã®ä¸€æ‹¬èª­ã¿è¾¼ã¿
- `Out-File -Encoding UTF8`: UTF-8ã§ã®å‡ºåŠ›
- `Select-String -Pattern`: æ­£è¦è¡¨ç¾ã«ã‚ˆã‚‹æ¤œç´¢

### Gité€£æº
- `git config core.autocrlf`: æ”¹è¡Œã‚³ãƒ¼ãƒ‰è‡ªå‹•å¤‰æ›è¨­å®š
- `git ls-files --eol`: ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥æ”¹è¡Œã‚³ãƒ¼ãƒ‰ç¢ºèª

### ãƒšãƒ¼ã‚¸ãƒ£ãƒ¼å›é¿è¨­å®šï¼ˆæ¨å¥¨ï¼‰
```powershell
# âœ… æ¨å¥¨ï¼šã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šã§ãƒšãƒ¼ã‚¸ãƒ£ãƒ¼å•é¡Œã‚’æ ¹æœ¬è§£æ±º
git config --global core.pager cat

# è¨­å®šå¾Œã¯é€šå¸¸ã®ã‚³ãƒãƒ³ãƒ‰ãŒãã®ã¾ã¾ä½¿ç”¨å¯èƒ½
git log --oneline -5
git diff
git show
```

## ğŸš¨ é‡è¦ãªä¿®æ­£å†…å®¹

### ä¿®æ­£1: è¦‹å‡ºã—ãƒ¬ãƒ™ãƒ«ã®çµ±ä¸€
**ä¿®æ­£å‰**: `$content -match "## Obsidian_to_Anki"`
**ä¿®æ­£å¾Œ**: `$content -match "# Obsidian_to_Anki"`
**ç†ç”±**: å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãƒ¬ãƒ™ãƒ«1è¦‹å‡ºã—ï¼ˆ#ï¼‰ã‚’ä½¿ç”¨

### ä¿®æ­£2: ENDãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾åˆ¤å®šã®ä¿®æ­£
**ä¿®æ­£å‰**: 
```powershell
if ($remainingLength -eq 0) {
    $results["æ­£å¸¸"] += $file.Name  # âŒ é–“é•ã£ãŸåˆ¤å®š
}
```
**ä¿®æ­£å¾Œ**: 
```powershell
if ($remainingLength -eq 0) {
    $results["æ”¹è¡Œã‚³ãƒ¼ãƒ‰å•é¡Œ"] += $file.Name  # âœ… æ­£ã—ã„åˆ¤å®š
    # ENDã®å¾Œã«æ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒå¿…è¦
}
```
**ç†ç”±**: 202ç•ªãƒ«ãƒ¼ãƒ«ã§ã¯ã€ŒENDã®å¾Œã«LFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ã€ãŒå¿…é ˆ

### ä¿®æ­£3: å“è³ªåŸºæº–ã®æ˜ç¢ºåŒ–
- **çœŸã®æ­£å¸¸çŠ¶æ…‹**: `remainingLength -eq 1` ã‹ã¤ `0x0A`ï¼ˆLFï¼‰
- **æ”¹è¡Œã‚³ãƒ¼ãƒ‰å•é¡Œ**: `remainingLength -eq 0`ï¼ˆENDãŒãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ï¼‰
- **æ”¹è¡Œã‚³ãƒ¼ãƒ‰å•é¡Œ**: `remainingLength -eq 1` ã‹ã¤ `0x0A`ï¼ˆLFã®ã¿ï¼‰
- **ENDã‚¹ãƒšãƒ¼ã‚¹å•é¡Œ**: `0x20`ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ï¼‰ãŒæœ€åˆã®ãƒã‚¤ãƒˆ

## æˆåŠŸäº‹ä¾‹

### æ–‡å­—ã‚³ãƒ¼ãƒ‰å•é¡Œã®è§£æ±ºäº‹ä¾‹
**å•é¡Œ**: ENDãƒãƒ¼ã‚«ãƒ¼å¾Œã®ã‚¹ãƒšãƒ¼ã‚¹ + æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ··åœ¨
**å¯¾å‡¦**: PowerShellã§ã®å®Œå…¨æ›¸ãç›´ã—ï¼ˆLFçµ±ä¸€ï¼‰
**çµæœ**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæ­£å¸¸èªè­˜ã€IDè‡ªå‹•ç”ŸæˆæˆåŠŸ

### ã‚³ãƒãƒ³ãƒ‰é•·åˆ¶é™å•é¡Œã®è§£æ±ºäº‹ä¾‹
**å•é¡Œ**: é•·ã„ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã§ããªã„
**å¯¾å‡¦**: 3æ®µéšã«åˆ†å‰²å®Ÿè¡Œ
**çµæœ**: æ­£å¸¸å®Ÿè¡Œã€æœŸå¾…ã•ã‚Œã‚‹çµæœã‚’å–å¾—

### æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯è¦‹é€ƒã—äº‹ä¾‹
**å•é¡Œ**: turn-ones-back-on-è¦‹æ¨ã¦ã‚‹.mdã§æ”¹è¡Œã‚³ãƒ¼ãƒ‰ä¸è¶³ã‚’è¦‹é€ƒã—
**åŸå› **: ENDãŒãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ã®å ´åˆã‚’ã€Œæ­£å¸¸ã€ã¨èª¤åˆ¤å®š
**æ•™è¨“**: 202ç•ªãƒ«ãƒ¼ãƒ«ã§ã¯ENDã®å¾Œã«å¿…ãšLFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ãŒå¿…è¦
**ä¿®æ­£**: remainingLength -eq 0 ã®å ´åˆã‚’ã€Œæ”¹è¡Œã‚³ãƒ¼ãƒ‰å•é¡Œã€ã«åˆ†é¡å¤‰æ›´

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- [[003-ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•.mdc]] - ãƒ‡ãƒãƒƒã‚°å…¨èˆ¬ã®æ‰‹æ³•
- [[202-Obsidian_to_Ankiç‹¬è‡ªå½¢å¼ç®¡ç†.mdc]] - ç‰¹å®šç”¨é€”ã§ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ç¢ºèª
- [[001-AIå®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³.mdc]] - AIå®Ÿè£…æ™‚ã®åŸºæœ¬åˆ¶ç´„

## é–¢æ•°æ°¸ç¶šæ€§å¯¾å¿œç­–

### ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®æ¨™æº–æ‰‹é †
```powershell
# å¿…è¦ãªé–¢æ•°ã‚’ä¸€æ‹¬å®šç¾©ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚å®Ÿè¡Œï¼‰
function Initialize-ObsidianToAnkiFunctions {
    # Test-ObsidianToAnkiFileé–¢æ•°ã®å®šç¾©
    function Global:Test-ObsidianToAnkiFile {
        param([string]$FilePath)
        if (!(Test-Path $FilePath)) { 
            Write-Host "ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $FilePath" -ForegroundColor Red
            return 
        }
        
        $content = Get-Content $FilePath -Raw -Encoding UTF8
        Write-Host "`n=== $FilePath è©³ç´°æ¤œè¨¼ ===" -ForegroundColor Cyan
        
            # åŸºæœ¬ãƒã‚§ãƒƒã‚¯ï¼ˆä¿®æ­£ï¼š# ãƒ¬ãƒ™ãƒ«1è¦‹å‡ºã—ï¼‰
    if ($content -notmatch "# Obsidian_to_Anki") { 
        Write-Host "âŒ Obsidian_to_Ankiã‚»ã‚¯ã‚·ãƒ§ãƒ³ãªã—" -ForegroundColor Red
        return 
    }
        if ($content -notmatch "START") { 
            Write-Host "âŒ STARTãƒãƒ¼ã‚«ãƒ¼ãªã—" -ForegroundColor Red
            return 
        }
        if ($content -notmatch "END") { 
            Write-Host "âŒ ENDãƒãƒ¼ã‚«ãƒ¼ãªã—" -ForegroundColor Red
            return 
        }
        
        # ENDãƒãƒ¼ã‚«ãƒ¼è©³ç´°ç¢ºèª
        $endMatches = [regex]::Matches($content, "END.*")
        foreach ($match in $endMatches) {
            $endText = $match.Value
            Write-Host "ENDãƒãƒ¼ã‚«ãƒ¼ç™ºè¦‹: '$endText'" -ForegroundColor Yellow
            if ($endText -match "END ") { 
                Write-Host "âŒ ENDã®å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ã‚ã‚Š" -ForegroundColor Red 
            } elseif ($endText -eq "END") { 
                Write-Host "âœ… ENDãƒãƒ¼ã‚«ãƒ¼æ­£å¸¸ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ï¼‰" -ForegroundColor Green 
            } else { 
                Write-Host "âœ… ENDãƒãƒ¼ã‚«ãƒ¼æ­£å¸¸" -ForegroundColor Green 
            }
        }
        
        # ãƒã‚¤ãƒŠãƒªãƒ¬ãƒ™ãƒ«ç¢ºèª
        $bytes = [System.IO.File]::ReadAllBytes($FilePath)
        $endIndex = -1
        for ($i = 0; $i -lt $bytes.Length - 2; $i++) {
            if ($bytes[$i] -eq 69 -and $bytes[$i+1] -eq 78 -and $bytes[$i+2] -eq 68) { 
                $endIndex = $i + 3
                break 
            }
        }
        
        if ($endIndex -gt 0 -and $endIndex -lt $bytes.Length) {
            $afterEndBytes = $bytes[$endIndex..($bytes.Length-1)]
            Write-Host "ENDå¾Œã®ãƒã‚¤ãƒˆ: " -NoNewline
            $afterEndBytes | ForEach-Object { Write-Host ("{0:X2} " -f $_) -NoNewline }
            Write-Host ""
            
            $lfCount = 0
            $crlfOnlyCount = 0
            for ($i = 0; $i -lt $afterEndBytes.Length - 1; $i++) {
                if ($afterEndBytes[$i] -eq 10) { 
                    $lfCount++ 
                } elseif ($afterEndBytes[$i] -eq 13) { 
                    $crlfOnlyCount++ 
                }
            }
            
            if ($crlfOnlyCount -gt 0) { 
                Write-Host "âŒ æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ··åœ¨å•é¡Œ: LF($lfCount) + CRLFå˜ä½“($crlfOnlyCount)" -ForegroundColor Red 
            } else { 
                Write-Host "âœ… æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ­£å¸¸: LFçµ±ä¸€" -ForegroundColor Green 
            }
        }
    }
    
    # Test-AllObsidianToAnkiFilesé–¢æ•°ã®å®šç¾©
    function Global:Test-AllObsidianToAnkiFiles {
        $mdFiles = Get-ChildItem -Path "." -Filter "*.md" | Where-Object { $_.Name -notlike "README.md" }
        Write-Host "=== å…¨mdãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼é–‹å§‹ ===" -ForegroundColor Magenta
        Write-Host "å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: $($mdFiles.Count)" -ForegroundColor Magenta
        Write-Host ""
        
        $results = @{ 
            "æ­£å¸¸" = @()
            "ENDã‚¹ãƒšãƒ¼ã‚¹å•é¡Œ" = @()
            "æ”¹è¡Œã‚³ãƒ¼ãƒ‰å•é¡Œ" = @()
            "ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸å­˜åœ¨" = @()
            "ãƒãƒ¼ã‚«ãƒ¼ä¸å­˜åœ¨" = @()
            "ãã®ä»–å•é¡Œ" = @() 
        }
        
        foreach ($file in $mdFiles) {
            $content = Get-Content $file.FullName -Raw
            if ($content -match "## Obsidian_to_Anki") {
                if ($content -match "END") {
                    $endIndex = $content.LastIndexOf("END")
                    $afterEndStart = $endIndex + 3
                    $remainingLength = $content.Length - $afterEndStart
                    
                    if ($remainingLength -eq 0) {
                        $results["æ­£å¸¸"] += $file.Name
                    } else {
                        $afterEnd = $content.Substring($afterEndStart, [Math]::Min(5, $remainingLength))
                        $bytes = [System.Text.Encoding]::UTF8.GetBytes($afterEnd)
                        
                        if ($bytes.Length -ge 1 -and $bytes[0] -eq 0x20) {
                            $results["ENDã‚¹ãƒšãƒ¼ã‚¹å•é¡Œ"] += $file.Name
                        } elseif ($bytes.Length -eq 1 -and $bytes[0] -eq 0x0A) {
                            $results["æ”¹è¡Œã‚³ãƒ¼ãƒ‰å•é¡Œ"] += $file.Name
                        } elseif ($bytes.Length -ge 2 -and $bytes[0] -eq 0x0D -and $bytes[1] -eq 0x0A) {
                            $results["æ­£å¸¸"] += $file.Name
                        } else {
                            $results["ãã®ä»–å•é¡Œ"] += $file.Name
                        }
                    }
                } else {
                    $results["ãƒãƒ¼ã‚«ãƒ¼ä¸å­˜åœ¨"] += $file.Name
                }
            } else {
                $results["ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸å­˜åœ¨"] += $file.Name
            }
        }
        
        # çµæœè¡¨ç¤º
        Write-Host "=== æ¤œè¨¼çµæœã‚µãƒãƒªãƒ¼ ===" -ForegroundColor Magenta
        foreach ($category in $results.Keys) {
            $count = $results[$category].Count
            if ($count -gt 0) {
                $color = switch ($category) {
                    "æ­£å¸¸" { "Green" }
                    "ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸å­˜åœ¨" { "Yellow" }
                    default { "Red" }
                }
                Write-Host "$category ($count ä»¶):" -ForegroundColor $color
                $results[$category] | ForEach-Object { Write-Host "  - $_" }
                Write-Host ""
            }
        }
    }
    
    Write-Host "âœ… Obsidian_to_Ankiæ¤œè¨¼é–¢æ•°ã‚’å®šç¾©ã—ã¾ã—ãŸ" -ForegroundColor Green
}

# ä½¿ç”¨æ–¹æ³•:
# 1. ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã« Initialize-ObsidianToAnkiFunctions ã‚’å®Ÿè¡Œ
# 2. Test-AllObsidianToAnkiFiles ã§ä¸€æ‹¬æ¤œè¨¼
# 3. Test-ObsidianToAnkiFile -FilePath "ãƒ•ã‚¡ã‚¤ãƒ«å" ã§å€‹åˆ¥æ¤œè¨¼
```

### é–¢æ•°å®šç¾©å¤±æ•—æ™‚ã®ä»£æ›¿æ‰‹é †
```powershell
# é–¢æ•°ãŒåˆ©ç”¨ã§ããªã„å ´åˆã®ç›´æ¥ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
# å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªã®ä»£æ›¿ã‚³ãƒãƒ³ãƒ‰
$filePath = "ãƒ•ã‚¡ã‚¤ãƒ«å.md"
$bytes = [System.IO.File]::ReadAllBytes($filePath)
$endIndex = -1
for ($i = 0; $i -lt $bytes.Length - 2; $i++) {
    if ($bytes[$i] -eq 69 -and $bytes[$i+1] -eq 78 -and $bytes[$i+2] -eq 68) { 
        $endIndex = $i + 3
        break 
    }
}
if ($endIndex -gt 0) {
    $afterEndBytes = $bytes[$endIndex..($bytes.Length-1)]
    Write-Host "ENDå¾Œã®ãƒã‚¤ãƒˆ: "
    $afterEndBytes | ForEach-Object { Write-Host ("{0:X2} " -f $_) -NoNewline }
    Write-Host ""
}
```

## æ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ä¸­æ–­æ™‚ã®å¾©æ—§æ‰‹é †

### ä¸­æ–­ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾å‡¦æ³•

#### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ä¸€æ‹¬æ¤œè¨¼ä¸­ã®ã‚¨ãƒ©ãƒ¼ä¸­æ–­
**ç—‡çŠ¶**: Test-AllObsidianToAnkiFileså®Ÿè¡Œä¸­ã«PSReadLineã‚¨ãƒ©ãƒ¼
**å¯¾å‡¦**:
1. **çµæœã®éƒ¨åˆ†ç¢ºèª**: ã‚¨ãƒ©ãƒ¼å‰ã®å‡ºåŠ›å†…å®¹ã‚’ç¢ºèª
2. **å•é¡Œãƒ•ã‚¡ã‚¤ãƒ«ç‰¹å®š**: ã‚¨ãƒ©ãƒ¼ç›´å‰ã«å‡¦ç†ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®š
3. **å€‹åˆ¥æ¤œè¨¼ç¶™ç¶š**: æ®‹ã‚Šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å€‹åˆ¥ã«ç¢ºèª

```powershell
# ä¸­æ–­æ™‚ã®å¾©æ—§ç”¨ã‚³ãƒãƒ³ãƒ‰
$remainingFiles = @("file1.md", "file2.md", "file3.md")  # æœªæ¤œè¨¼ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
foreach ($file in $remainingFiles) {
    Write-Host "=== $file æ¤œè¨¼ ===" -ForegroundColor Yellow
    $content = Get-Content $file -Raw
    if ($content -match "## Obsidian_to_Anki") {
        if ($content -match "END ") { 
            Write-Host "âŒ ENDã‚¹ãƒšãƒ¼ã‚¹å•é¡Œ: $file" -ForegroundColor Red 
        } else { 
            Write-Host "âœ… æ­£å¸¸: $file" -ForegroundColor Green 
        }
    } else {
        Write-Host "âš ï¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä¸å­˜åœ¨: $file" -ForegroundColor Yellow
    }
}
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³2: å€‹åˆ¥æ¤œè¨¼ä¸­ã®é–¢æ•°èªè­˜ã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**: Test-ObsidianToAnkiFileé–¢æ•°ãŒèªè­˜ã•ã‚Œãªã„
**å¯¾å‡¦**:
1. **ç›´æ¥ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**: é–¢æ•°ã‚’ä½¿ã‚ãªã„æ¤œè¨¼æ–¹æ³•
2. **ç°¡ç•¥ç‰ˆãƒã‚§ãƒƒã‚¯**: æœ€ä½é™ã®ç¢ºèªé …ç›®ã®ã¿å®Ÿè¡Œ

```powershell
# é–¢æ•°ãªã—ã§ã®å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
$file = "å•é¡Œãƒ•ã‚¡ã‚¤ãƒ«.md"
$content = Get-Content $file -Raw
Write-Host "=== $file ç°¡ç•¥æ¤œè¨¼ ===" -ForegroundColor Cyan

# åŸºæœ¬ãƒã‚§ãƒƒã‚¯ï¼ˆä¿®æ­£ï¼š# ãƒ¬ãƒ™ãƒ«1è¦‹å‡ºã—ï¼‰
$hasSection = $content -match "# Obsidian_to_Anki"
$hasEnd = $content -match "END"
$hasEndSpace = $content -match "END "

Write-Host "Obsidian_to_Ankiã‚»ã‚¯ã‚·ãƒ§ãƒ³: $(if($hasSection){'âœ…'}else{'âŒ'})"
Write-Host "ENDãƒãƒ¼ã‚«ãƒ¼: $(if($hasEnd){'âœ…'}else{'âŒ'})"
Write-Host "ENDã‚¹ãƒšãƒ¼ã‚¹å•é¡Œ: $(if($hasEndSpace){'âŒ ã‚ã‚Š'}else{'âœ… ãªã—'})"

# æ”¹è¡Œã‚³ãƒ¼ãƒ‰ç¢ºèª
if ($hasEnd -and -not $hasEndSpace) {
    $bytes = [System.IO.File]::ReadAllBytes($file)
    $lastBytes = $bytes[-5..-1]
    Write-Host "æœ«å°¾ãƒã‚¤ãƒˆ: "
    $lastBytes | ForEach-Object { Write-Host ("{0:X2} " -f $_) -NoNewline }
    Write-Host ""
}
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ä¿®æ­£å¾Œã®å†æ¤œè¨¼å¤±æ•—
**ç—‡çŠ¶**: ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£å¾Œã®ç¢ºèªã§ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ
**å¯¾å‡¦**:
1. **ä¿®æ­£çµæœã®ç›´æ¥ç¢ºèª**: ãƒã‚¤ãƒŠãƒªãƒ¬ãƒ™ãƒ«ã§ã®ç¢ºèª
2. **éƒ¨åˆ†æ¤œè¨¼**: ä¿®æ­£ç®‡æ‰€ã®ã¿ã®ç¢ºèª

```powershell
# ä¿®æ­£å¾Œã®ç¢ºèªç”¨ç°¡ç•¥ã‚³ãƒãƒ³ãƒ‰
$modifiedFile = "ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«.md"
Write-Host "=== $modifiedFile ä¿®æ­£çµæœç¢ºèª ===" -ForegroundColor Green

# ENDå¾Œã®ãƒã‚¤ãƒˆç¢ºèªã®ã¿
$bytes = [System.IO.File]::ReadAllBytes($modifiedFile)
$endIndex = -1
for ($i = 0; $i -lt $bytes.Length - 2; $i++) {
    if ($bytes[$i] -eq 69 -and $bytes[$i+1] -eq 78 -and $bytes[$i+2] -eq 68) { 
        $endIndex = $i + 3
        break 
    }
}

if ($endIndex -gt 0) {
    $afterEndBytes = $bytes[$endIndex..($bytes.Length-1)]
    if ($afterEndBytes.Length -eq 1 -and $afterEndBytes[0] -eq 0x0A) {
        Write-Host "âœ… ä¿®æ­£æˆåŠŸ: LFæ­£å¸¸" -ForegroundColor Green
    } else {
        Write-Host "âŒ ä¿®æ­£ä¸å®Œå…¨: " -NoNewline -ForegroundColor Red
        $afterEndBytes | ForEach-Object { Write-Host ("{0:X2} " -f $_) -NoNewline }
        Write-Host ""
    }
}
```

## ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾å‡¦æ³•ã®æ‹¡å……

### æ–°ã—ã„ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³

#### ãƒ‘ã‚¿ãƒ¼ãƒ³5: é–¢æ•°æ°¸ç¶šæ€§å•é¡Œ
**ç—‡çŠ¶**: å®šç¾©ã—ãŸé–¢æ•°ãŒæ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§èªè­˜ã•ã‚Œãªã„
**å¯¾å‡¦**: 
1. **Global ã‚¹ã‚³ãƒ¼ãƒ—æŒ‡å®š**: `function Global:FunctionName` ã§å®šç¾©
2. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶š**: åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§ã®é€£ç¶šå®Ÿè¡Œ
3. **ä»£æ›¿ã‚³ãƒãƒ³ãƒ‰**: é–¢æ•°ãªã—ã§ã®ç›´æ¥å®Ÿè¡Œ

#### ãƒ‘ã‚¿ãƒ¼ãƒ³6: æ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ä¸­æ–­
**ç—‡çŠ¶**: ä¸€æ‹¬å‡¦ç†ä¸­ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹ä¸­æ–­ã‚„äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼
**å¯¾å‡¦**:
1. **éƒ¨åˆ†çµæœã®ä¿å­˜**: ä¸­æ–­å‰ã®çµæœã‚’è¨˜éŒ²
2. **å†é–‹ãƒã‚¤ãƒ³ãƒˆç‰¹å®š**: æœªå‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å®š
3. **æ®µéšçš„å¾©æ—§**: å€‹åˆ¥å‡¦ç†ã§ã®ç¶™ç¶š

## äºˆé˜²ç­–ã®å¼·åŒ–

### æ¤œè¨¼ä½œæ¥­é–‹å§‹æ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] **é–¢æ•°å®šç¾©ç¢ºèª**: `Initialize-ObsidianToAnkiFunctions` å®Ÿè¡Œæ¸ˆã¿
- [ ] **ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç¢ºèª**: æ­£ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹
- [ ] **ãƒ•ã‚¡ã‚¤ãƒ«æ•°ç¢ºèª**: å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã®äº‹å‰æŠŠæ¡
- [ ] **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª**: é‡è¦ãªå¤‰æ›´å‰ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### ä¸­æ–­æ™‚ã®æƒ…å ±è¨˜éŒ²
- **å‡¦ç†æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«**: æ­£å¸¸ç¢ºèªæ¸ˆã¿ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
- **å•é¡Œãƒ•ã‚¡ã‚¤ãƒ«**: ä¿®æ­£ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ  
- **æœªå‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«**: ã¾ã ç¢ºèªã—ã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
- **ã‚¨ãƒ©ãƒ¼å†…å®¹**: ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã®è©³ç´°

## æ”¹è¡Œã‚³ãƒ¼ãƒ‰ç®¡ç†ã®äº‹å¾Œå‡¦ç†ï¼ˆ2025-07-02 æ–°è¦è¿½åŠ ï¼‰

### èƒŒæ™¯ã¨é‡è¦æ€§
**Obsidian-to-Ankiãƒ—ãƒ©ã‚°ã‚¤ãƒ³å¯¾å¿œ**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯LFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ã®ã¿ã‚’èªè­˜ã™ã‚‹ãŸã‚ã€CRLFæ··åœ¨ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç„¡è¦–ã•ã‚Œã‚‹

### ä»Šå›ã®å®Ÿè¨¼äº‹ä¾‹ï¼ˆ2025-07-02ï¼‰
**å•é¡Œç™ºç”Ÿ**: `turn-ones-back-on-è¦‹æ¨ã¦ã‚‹.md`ï¼ˆCRLFæ”¹è¡Œï¼‰ãŒObsidian-to-Ankiãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§èªè­˜ã•ã‚Œãªã„
**è§£æ±ºæˆåŠŸ**: æ®µéšçš„åˆ†å‰²å®Ÿè¡Œã«ã‚ˆã‚‹CRLFâ†’LFå¤‰æ›ã§å®Œå…¨è§£æ±º
**çµæœ**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæ­£å¸¸ã«ãƒ•ã‚¡ã‚¤ãƒ«èªè­˜ã€ã‚«ãƒ¼ãƒ‰ç”ŸæˆæˆåŠŸ

### æ¨™æº–å¯¾å‡¦ãƒ•ãƒ­ãƒ¼ï¼ˆæ®µéšçš„åˆ†å‰²å®Ÿè¡Œï¼‰

#### å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®æ”¹è¡Œã‚³ãƒ¼ãƒ‰ä¿®æ­£
```powershell
# Step 1: æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ¤œå‡º
$file = "å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«.md"
$bytes = [System.IO.File]::ReadAllBytes($file)
$hasCRLF = $false; $hasLF = $false
for ($i = 0; $i -lt $bytes.Length - 1; $i++) {
    if ($bytes[$i] -eq 0x0D -and $bytes[$i + 1] -eq 0x0A) { $hasCRLF = $true; break }
    elseif ($bytes[$i] -eq 0x0A) { $hasLF = $true; break }
}

# Step 2: CRLFæ¤œå‡ºæ™‚ã®è‡ªå‹•ä¿®æ­£
if ($hasCRLF) {
    Write-Host "CRLFæ¤œå‡º: ä¿®æ­£å®Ÿæ–½" -ForegroundColor Yellow
    $content = Get-Content $file -Raw
    $contentLF = $content -replace "`r`n", "`n"
    $utf8NoBom = New-Object System.Text.UTF8Encoding($false)
    [System.IO.File]::WriteAllText($file, $contentLF, $utf8NoBom)
    Write-Host "CRLFâ†’LFå¤‰æ›å®Œäº†" -ForegroundColor Green
} else {
    Write-Host "LFç¢ºèª: ä¿®æ­£ä¸è¦" -ForegroundColor Green
}

# Step 3: å¤‰æ›å¾Œã®ç¢ºèª
$bytesAfter = [System.IO.File]::ReadAllBytes($file)
$lastBytes = $bytesAfter[-5..-1]
Write-Host "æœ«å°¾ãƒã‚¤ãƒˆç¢ºèª: "
$lastBytes | ForEach-Object { Write-Host ("{0:X2} " -f $_) -NoNewline }
Write-Host ""
```

#### è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†
```powershell
# Step 1: å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«åé›†
$files = Get-ChildItem -Filter "*.md" | Select-Object -ExpandProperty Name
Write-Host "å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: $($files.Count)" -ForegroundColor Cyan

# Step 2: æ”¹è¡Œã‚³ãƒ¼ãƒ‰æ¤œå‡ºã¨çµ±è¨ˆ
$crlfFiles = @()
$lfFiles = @()
foreach ($file in $files) {
    $bytes = [System.IO.File]::ReadAllBytes($file)
    $hasCRLF = $false
    for ($i = 0; $i -lt $bytes.Length - 1; $i++) {
        if ($bytes[$i] -eq 0x0D -and $bytes[$i + 1] -eq 0x0A) { 
            $hasCRLF = $true; break 
        }
    }
    if ($hasCRLF) { $crlfFiles += $file } else { $lfFiles += $file }
}

# Step 3: çµæœè¡¨ç¤º
Write-Host "CRLFæ¤œå‡ºãƒ•ã‚¡ã‚¤ãƒ«: $($crlfFiles.Count) ä»¶" -ForegroundColor Red
$crlfFiles | ForEach-Object { Write-Host "  - $_" -ForegroundColor Yellow }
Write-Host "LFæ­£å¸¸ãƒ•ã‚¡ã‚¤ãƒ«: $($lfFiles.Count) ä»¶" -ForegroundColor Green

# Step 4: ä¸€æ‹¬ä¿®æ­£ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
if ($crlfFiles.Count -gt 0) {
    Write-Host "ä¸€æ‹¬CRLFâ†’LFå¤‰æ›ã‚’å®Ÿè¡Œã—ã¾ã™ã‹? (Y/N)" -ForegroundColor Yellow
    # å®Ÿéš›ã®å¤‰æ›å‡¦ç†ã¯æ‰‹å‹•ç¢ºèªå¾Œã«å®Ÿè¡Œ
}
```

### å¿…é ˆå®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°
1. **Ankiãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãƒ»ç·¨é›†å¾Œ**: å…¨ã¦ã®Ankiå¯¾å¿œãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦å®Ÿè¡Œ
2. **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³èªè­˜å•é¡Œç™ºç”Ÿæ™‚**: Obsidian-to-Ankiãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒåå¿œã—ãªã„å ´åˆ
3. **å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**: é€±æ¬¡ãƒ»æœˆæ¬¡ã§ã®ä¸€æ‹¬ãƒã‚§ãƒƒã‚¯

### äºˆé˜²ç­–
- **ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®š**: LFæ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã«
- **Gitè¨­å®š**: `core.autocrlf=false` ã§æ”¹è¡Œã‚³ãƒ¼ãƒ‰å¤‰æ›ã‚’ç„¡åŠ¹åŒ–  
- **äº‹å¾Œç¢ºèª**: ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œå¾Œã®å¿…é ˆãƒã‚§ãƒƒã‚¯é …ç›®ã¨ã—ã¦å®šä¾‹åŒ–
