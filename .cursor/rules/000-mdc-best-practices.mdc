---
description: ".mdc ファイル作成のベストプラクティス"
globs: ["**/*.mdc"]
tags: ["mdc", "best-practices", "file-management", "meta-rule"]
priority: 1
version: "2.0.0"
alwaysApply: false
---
# .mdc ファイル作成のベストプラクティス

このルールは、Cursor における .mdc ファイルの作成と管理に関するベストプラクティスを定義し、AI エージェントがこれらのルールを正確に解釈し、適切に適用することを目的としています。

## 1. ファイルの配置と命名
- .mdc ファイルは、プロジェクトの .cursor/rules/ ディレクトリ直下に配置します。
- 命名規則として、3桁の番号と説明的な名前を組み合わせます。例: 001-core-standards.mdc

## 2. フロントマターの構成
- description フィールドには、ルールの目的を簡潔に記述します。
- globs フィールドには、ルールを適用するファイルパターンを指定します。
- tags フィールドには、ルールのカテゴリを示すタグを配列で指定します。
- priority フィールドには、ルールの適用優先度を数値で指定します（1が最高）。
- version フィールドには、Semantic Versioning に従ったバージョン番号を指定します。

### mdcファイル特有の編集制限（復活）
- **フロントマター可視性の制約**: AIエージェントはmdcファイルのフロントマターを正確に認識できない場合があります
- **mdcファイルのフロントマター編集禁止**: AIエージェントによるmdcファイルのフロントマター編集は一切行いません
- **mdcファイルの編集範囲**: mdcファイルの編集はMarkdownコンテンツ部分のみを対象とします
- **mdcファイルのフロントマター変更時**: フロントマターの変更が必要な場合は、ユーザーに提案のみを行います
- **mdファイルとの区別**: 通常のmdファイルのフロントマター編集は制限されません

### ファイル削除の絶対禁止
- **緊急時削除禁止**: いかなる状況でもAIエージェントによるファイル削除は絶対に実行しません
- **問題解決の代替手段**: ファイル削除以外の方法で問題解決を図ります
- **ユーザー報告**: 重大な問題はユーザーに報告し、手動対応を要請します
- **安全性優先**: データ保護を最優先とし、修復不可能な操作を回避します

### 誤修正発生時の厳格な対応原則（復活）
- **絶対的再修正禁止**: frontmatterを誤修正した場合、いかなる理由があっても復元・再修正を行いません
- **即座報告**: 誤修正が発生した瞬間に事実を報告し、それ以上の操作を停止します
- **ユーザー委任**: 全ての修正権限をユーザーに委任し、AI側での判断・操作を一切行いません
- **作業継続**: frontmatter誤修正とは独立してコンテンツ部分の作業は継続実施します
- **安全優先**: システム安全性をコンテンツ完成度より優先します

## 3. 禁止されるファイル操作

### 絶対禁止操作
- **ファイル削除**: `delete_file`ツールの使用は絶対禁止
- **mdcファイル移動**: .mdcファイルの移動操作禁止
- **一括操作**: 複数ファイルを同時に変更する危険な操作禁止

### 制限付き操作
- **mdcファイル編集**: Markdownコンテンツ部分のみ許可
- **新規作成**: ユーザー明示的指示がある場合のみ
- **バックアップなし変更**: 重要変更前の状況確認必須

## 4. エラー処理・安全性確保

### 問題発生時の対応順序
1. **即座停止**: 危険な操作を検出した時点で全停止
2. **状況報告**: 何が起きたかを詳細に報告
3. **ユーザー委任**: 判断・修正権限をユーザーに完全移譲
4. **待機**: ユーザー指示があるまで追加操作禁止

### 安全性チェックリスト
- [ ] ファイル削除操作を使用していないか
- [ ] mdcファイルのフロントマター編集を行っていないか
- [ ] 複数ファイルの同時変更を避けているか
- [ ] 問題発生時に適切に停止・報告したか

## 5. mdcファイルフロントマター完全除外方針

### 🚨 Cursor上のAIエージェント制約

**根本的問題:**
- Cursor上でAIエージェントが先頭の `---` を見逃すシステムバグが存在
- 正常なフロントマターを「異常」と誤判定
- 重複フロントマターを「正常」と誤判定
- **AIによる診断・評価は信頼できない**

### 実証された問題例

#### ケース1: 誤った「正常」判定
```yaml
# AIが「正常」と判定したが、実際は重複
---
description: 
globs: 
alwaysApply: false
---
---  
description: 品詞分類整理・文法学習用ドキュメント作成の基本方針
# （重複フロントマター）
```

#### ケース2: 誤った「異常」判定  
```yaml
# AIが「フロントマターなし」と判定したが、実際は正常
---
description: 基本編集ルール（常時適用）
globs: 
alwaysApply: true
---
```

### 完全除外方針

#### 絶対禁止事項
- **診断禁止**: mdcファイルフロントマターの状況診断
- **評価禁止**: フロントマター構造の良否判定
- **報告禁止**: フロントマター関連問題の指摘
- **修正禁止**: フロントマター内容の変更・追加・削除
- **提案禁止**: フロントマター改善の提案

#### AI認識限界の受容
- **不可視前提**: フロントマターは「見えない」ものとして扱う
- **無評価原則**: 存在・内容・正確性について一切言及しない
- **ユーザー専有**: フロントマター領域はユーザー完全管理
- **制約遵守**: システムバグを前提とした安全な動作

### 運用プロトコル

#### mdcファイル編集時
1. **フロントマター領域の回避**: コンテンツ部分のみ編集
2. **状況確認の禁止**: フロントマターの存在・状態を確認しない
3. **構造保護**: 既存の区切り文字（`---`）に一切触れない
4. **完全分離**: Markdownコンテンツとフロントマターの完全分離

#### 問題発生時の対応
```
🚨 mdcファイルフロントマター関連事項

【AI側の制約】
- 診断・評価・修正は一切実施できません
- システムバグによりAI判断は信頼できません

【ユーザー様へのお願い】
- フロントマター関連は完全にユーザー様管理でお願いします
- AI側では一切の関与・支援を行いません

【継続可能な作業】
- Markdownコンテンツ部分の編集は継続実施します
```

### 技術的根拠
- **Cursorシステムバグ**: 先頭 `---` 認識の不安定性
- **可視性問題**: AIエージェントの部分的可視制約
- **判断信頼性**: 診断システムの根本的信頼性欠如
- **安全性優先**: データ破損リスクの完全回避
