---
description: "Obsidian_to_Anki独自形式でのAnkiカード作成・管理に関する専門ルール - START/END形式・WithSpeech対応・Tags統合を含む包括的カード生成ガイド"
globs: ["*.md"]
alwaysApply: false
---
# Obsidian_to_Anki独自形式管理

## 目的
- TOEIC学習用mdファイルに、統一された独自形式のObsidian_to_Ankiカード定義を作成する
- START/END形式によるカード境界の明確化
- WithSpeech機能による音声学習対応
- Tags統合による効率的な分類管理

## 基本形式

### カード定義の構造
```
# Obsidian_to_Anki
START
WithSpeech
[表現]

[英語例文]
Back: 
[表現]
[日本語意味]

[英語例文]
[日本語訳]

関連表現
[関連表現1] - [説明1]
[関連表現2] - [説明2]

TOEIC優先度:[数値]
Part[番号]:[出題文脈]
Ankiラベル:[ラベル名]
Speech: [英語例文]
Tags: TOEIC優先度:[数値] Ankiラベル:[ラベル名] Part[番号]:[出題文脈]
END
```

## 必須構成要素

### 1. セクション開始
- `# Obsidian_to_Anki`: セクション見出し
- `START`: カード定義開始マーカー
- `WithSpeech`: 音声機能有効化

### 2. カード表面
- **表現**: 学習対象の英語表現
- **英語例文**: 実用的な例文（TOEIC形式推奨）

### 3. カード裏面（Back:以降）
- **表現**: 表面と同じ英語表現
- **日本語意味**: 簡潔な意味説明
- **英語例文**: 表面と同じ例文
- **日本語訳**: 例文の自然な日本語訳

### 4. 補足情報
- **関連表現**: 類似・関連する表現とその説明
- **TOEIC優先度**: 数値（0-100）
- **Part情報**: 出題パートと文脈
- **Ankiラベル**: カード分類用ラベル

### 5. メタデータ
- **Speech**: 音声読み上げ対象の英文
- **Tags**: 検索・分類用タグの統合
- **ID**: 自動生成される一意識別子
- `END`: カード定義終了マーカー

## 作成手順

### Step 1: 基本情報の収集
既存のmdファイルから以下の情報を抽出：
- 表現（title）
- 英語例文（## 例文セクション）
- 日本語意味（## 基本情報の意味）
- 日本語訳（例文の翻訳）
- TOEIC優先度（基本情報またはタグ）
- Part情報（TOEIC出題文脈）
- 関連表現（## 関連表現セクション）

### Step 2: カード定義の作成
1. ファイル末尾に `# Obsidian_to_Anki` セクションを追加
2. 基本形式に従って各要素を配置
3. 関連表現の整理（リンク記法を除去）
4. Tags行の統合（重要情報を1行にまとめ）

### Step 3: ID生成
- 13桁のタイムスタンプ形式を使用
- 例: `1750448492768`
- 重複を避けるため、作成時刻ベースで生成

### Step 3: ID管理
- **自動生成**: IDはObsidian_to_Ankiプラグインが初回同期時に自動生成
- **プロジェクト側対応**: 
  - 新規作成時: `<!--ID: [自動生成ID]-->` の行は**作成しない**
  - 既存ファイル: IDが既に記載されている場合は**絶対に変更しない**
- **ID形式**: 13桁のタイムスタンプ形式（例: `1750448492768`）
- **管理方針**: IDの生成・更新は完全にObsidian_to_Ankiプラグインに委任

## 品質基準

### 必須チェック項目
- [ ] START/ENDマーカーが正しく配置されているか
- [ ] WithSpeech指定が含まれているか
- [ ] Back:セクションが適切に分離されているか
- [ ] Speech行が英語例文と一致しているか
- [ ] Tags行に必要な情報が統合されているか
- [ ] ID行は新規作成時に含めていないか（プラグイン自動生成のため）

### 品質チェック項目
- [ ] 表現が明確で学習に適しているか
- [ ] 例文がTOEIC形式に準拠しているか
- [ ] 日本語訳が自然で理解しやすいか
- [ ] 関連表現が適切に選択されているか
- [ ] TOEIC優先度が妥当な範囲内か（0-100）
- [ ] Part情報が正確か

## 既存ファイルへの適用

### 対象ファイル
- ルートディレクトリの全TOEIC学習用mdファイル
- 慣用句・句動詞・表現ファイル

### 作成元データソース
**`tango/back.md`の2つの表を主要データソースとして活用**
1. **Ankiラベル別実用文例** - TOEIC優先度順の包括的表現リスト
2. **慣用表現一覧** - 慣用的意味に特化した表現リスト

これらの表から抽出した表現について、個別ページを作成し、202番ルール形式のObsidian_to_Ankiセクションを実装する。

#### 分類統一ルール
**慣用表現一覧の「分類」と実用文例の「Ankiラベル」は同一扱いとして展開**
- 慣用表現一覧の「分類」欄 = 実用文例の「Ankiラベル」欄
- 両表間で同じ表現が存在する場合、分類・ラベルは統一して使用
- 個別ページ作成時のAnkiラベル設定は、両表の情報を統合して決定
- 例: 慣用表現「分離句動詞」= 実用文例「分離句動詞副詞」→「分離句動詞副詞」として統一

### 適用優先順位
1. 高頻出度表現（優先度80以上）
2. Part5-7頻出表現
3. その他のTOEIC関連表現

### 適用除外
- `tango/`ディレクトリ内ファイル（参照専用）
- ルールファイル（.mdc）
- インデックスファイル

## 保守・更新

### 定期チェック
- カード定義の一貫性確認
- **ID管理の確認**（既存IDの保護・新規IDの未作成）
- Tags統合の妥当性確認

### 更新時の注意点
- **既存IDは絶対に変更・削除しない**
- **新規ファイルにIDを事前作成しない**
- Speech行は例文変更時に同期更新
- Tags行は情報追加時に再統合

### ID管理の重要事項
- **プラグイン権限**: IDの生成・管理はObsidian_to_Ankiプラグインの専権事項
- **手動操作禁止**: プロジェクト側でのID作成・編集・削除は禁止
- **同期依存**: 初回同期後にIDが自動付与されることを前提とした運用

## 関連ファイル
- [[100-基本方針.mdc]] - TOEIC・Anki特化基本方針
- [[200-Ankiカード作成統合管理.mdc]] - Ankiカード統合管理
- [[201-Ankiデッキ構造管理.mdc]] - デッキ構造・学習管理

## 🔗 他ルールとの連携

### [[200-Ankiカード作成統合管理.mdc]]との連携
- 全体方針の遵守
- 優先度基準の統一（0-100スケール）
- ファイル構造・命名規則の整合性
- 実装フローとの連携

### [[201-Ankiデッキ構造管理.mdc]]との連携
- Tags行でのデッキ指定統一
- 優先度別デッキ分類の反映
- 学習進度管理との連携
- デッキ命名規則の遵守

### [[100-基本方針.mdc]]との連携
- TOEIC学習目標の反映
- タグ設定原則の遵守
- 相互参照システムとの整合性

## 実装例

### 慣用句の場合
```
# Obsidian_to_Anki
START
WithSpeech
back to back

We have two meetings back to back this afternoon.
Back: 
back to back
連続して・立て続けに

We have two meetings back to back this afternoon.
今日の午後、会議が2つ連続して入っています。

関連表現
back-and-forth-往復して - 行ったり来たり
one-after-another-連続して - 次々と

TOEIC優先度:85
Part4:スケジュール調整
Ankiラベル:慣用句
Speech: We have two meetings back to back this afternoon.
Tags: TOEIC優先度:85 Ankiラベル:慣用句 Part4:スケジュール調整
END
```
※ ID行は初回同期時にObsidian_to_Ankiプラグインが自動追加

### 句動詞の場合
```
# Obsidian_to_Anki
START
WithSpeech
back up

Please back up all important files before the update.
Back: 
back up
バックアップする

Please back up all important files before the update.
更新前に重要なファイルをすべてバックアップしてください。

関連表現
save-保存する - データを保存する
store-蓄える - 情報を蓄える

TOEIC優先度:100
Part4:IT関連業務指示
Ankiラベル:分離句動詞副詞
Speech: Please back up all important files before the update.
Tags: TOEIC優先度:100 Ankiラベル:分離句動詞副詞 Part4:IT関連業務指示
END
```
※ ID行は初回同期時にObsidian_to_Ankiプラグインが自動追加
